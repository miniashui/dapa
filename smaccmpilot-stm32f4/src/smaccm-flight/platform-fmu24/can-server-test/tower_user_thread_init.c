/* This file has been autogenerated by Ivory
 * Compiler version  0.1.0.5
 */
#include "tower_user_thread_init.h"

static void emitter_set_chan_190(const struct i2c_transaction_request *n_var0);

static void emitter_i2c2_request_chan_191(const struct i2c_transaction_result *n_var0);

static void emitter_dmauart_hw_init_chan_151(const int64_t *n_var0);

static void emitter_new_state_chan_29(const struct sensors_result *n_var0);

static void emitter_att_est_gyro_chan_189(const struct AhrsMlkf *n_var0);

static void emitter_att_est_mag_chan_189(const struct AhrsMlkf *n_var0);

static void emitter_att_est_accel_chan_189(const struct AhrsMlkf *n_var0);

static void emitter_write_mag_output_attr_chan_34(const struct magnetometer_sample *n_var0);

static void emitter_write_gyro_output_attr_chan_30(const struct gyroscope_sample *n_var0);

static void emitter_write_baro_output_attr_chan_32(const struct barometer_sample *n_var0);

static void emitter_write_accel_output_attr_chan_31(const struct accelerometer_sample *n_var0);

static void emitter_motion_light_debug_2_chan_23(const struct rgb_led_setting *n_var0);

static void emitter_detectMotion_2_accel_chan_188(const bool *n_var0);

static void emitter_spi1_scheduler_ready_chan_158(const struct spi_transaction_request *n_var0);

static void emitter_spi1_scheduler_l3gd20_chan_158(const struct spi_transaction_request *n_var0);

static void emitter_spi1_scheduler_ms5611_chan_158(const struct spi_transaction_request *n_var0);

static void emitter_spi1_scheduler_lsm303d_chan_158(const struct spi_transaction_request *n_var0);

static void emitter_spi1_scheduler_mpu6000_chan_158(const struct spi_transaction_request *n_var0);

static void emitter_ms5611_init_chan_178(const bool *n_var0);

static void emitter_ms5611_chan_175(const struct spi_transaction_request *n_var0);

static void emitter_ms5611_chan_177(const struct barometer_sample *n_var0);

static void emitter_lsm303d_coroutine_init_chan_174(const bool *n_var0);

static void emitter_lsm303d_coroutine_chan_170(const struct spi_transaction_request *n_var0);

static void emitter_lsm303d_coroutine_chan_172(const struct magnetometer_sample *n_var0);

static void emitter_mpu6000_init_chan_169(const bool *n_var0);

static void emitter_mpu6000_chan_167(const struct spi_transaction_request *n_var0);

static void emitter_mpu6000_chan_157(const struct gyroscope_sample *n_var0);

static void emitter_mpu6000_chan_156(const struct accelerometer_sample *n_var0);

static void emitter_l3gd20_init_chan_166(const bool *n_var0);

static void emitter_l3gd20_chan_164(const struct spi_transaction_request *n_var0);

static void emitter_l3gd20_chan_162(const int64_t *n_var0);

static void emitter_init_2_chan_161(const int64_t *n_var0);

static void emitter_initialize_hardware_chan_160(const int64_t *n_var0);

static void emitter_write_gps_output_attr_chan_37(const struct position_sample *n_var0);

static void emitter_ublox_init_chan_147(const struct position_sample *n_var0);

void callback_i2c_response_thread_init(const struct i2c_transaction_result *n_var0)
{
    bool n_deref0 = expect_response;
    
    if (n_deref0) {
        uint8_t n_deref1 = n_var0->resultcode;
        
        if ((bool) (n_deref1 > 0)) {
            error = (uint8_t) 3U;
        }
    } else {
        error = (uint8_t) 2U;
    }
    expect_response = false;
}

void callback_set_thread_init(const struct rgb_led_setting *n_var0)
{
    bool n_deref0 = expect_response;
    
    if ((bool) !n_deref0) {
        expect_response = true;
        
        uint8_t n_deref1 = n_var0->red;
        uint8_t n_deref2 = n_var0->green;
        uint8_t n_deref3 = n_var0->blue;
        struct i2c_transaction_request n_local4 = {.tx_addr =(uint8_t) 85U, .tx_buf ={(uint8_t) 129U, (uint8_t) ((bool) (n_deref3 > (uint8_t) 15U) ? (uint8_t) 15U : n_deref3), (uint8_t) 130U, (uint8_t) ((bool) (n_deref2 > (uint8_t) 15U) ? (uint8_t) 15U : n_deref2), (uint8_t) 131U, (uint8_t) ((bool) (n_deref1 > (uint8_t) 15U) ? (uint8_t) 15U : n_deref1)}, .tx_len =(int32_t) 6, .rx_len =
                                                   (int32_t) 0};
        struct i2c_transaction_request *n_ref5 = &n_local4;
        
        emitter_set_chan_190(n_ref5);
    }
}

void callback_i2c2_request_thread_init(const struct i2c_transaction_request *n_var0)
{
    bool n_deref0 = i2c2_ready_sent;
    uint8_t n_deref1 = i2c2_driverstate;
    
    if ((bool) (n_deref0 && (bool) (0 == n_deref1))) {
        /* reg get i2c2->cr1:  */
        ;
        
        uint16_t n_r2 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
        
        if ((bool) ((bool) (0 != (uint8_t) (uint16_t) ((uint16_t) (n_r2 >> (uint16_t) 8U) & (uint16_t) 1U)) || (bool) (0 != (uint8_t) (uint16_t) ((uint16_t) (n_r2 >> (uint16_t) 9U) & (uint16_t) 1U)))) {
            uint32_t n_deref3 = i2c2_error_run;
            
            i2c2_error_run = (uint32_t) ((uint32_t) 1U + n_deref3);
            
            uint16_t n_r4 = ivory_hw_io_read_u16((uint32_t) 1073764372U);
            
            /* reg modify i2c2->sr1: clearBit i2c_sr1_smbalert, clearBit i2c_sr1_timeout, clearBit i2c_sr1_pecerr, clearBit i2c_sr1_ovr, clearBit i2c_sr1_af, clearBit i2c_sr1_arlo, clearBit i2c_sr1_berr, clearBit i2c_sr1_txe, clearBit i2c_sr1_rxne, clearBit i2c_sr1_stopf, clearBit i2c_sr1_add10, clearBit i2c_sr1_btf, clearBit i2c_sr1_addr, clearBit i2c_sr1_sb */
            ;
            
            uint16_t n_cse31 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 10U);
            uint16_t n_cse34 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 9U);
            uint16_t n_cse37 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 8U);
            
            ivory_hw_io_write_u16((uint32_t) 1073764372U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) (n_r4 & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 15U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 14U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U <<
                                                                                                                                                                                                                                                                                                                                                                                         (uint16_t) 12U)) &
                                                                                                                                                                                              (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 11U)) & n_cse31) & n_cse34) & n_cse37) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 7U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 6U)) &
                                                                                                                      (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 4U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 3U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 2U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 1U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << 0)));
            
            uint16_t n_r5 = ivory_hw_io_read_u16((uint32_t) 1073764356U);
            
            /* reg modify i2c2->cr2: clearBit i2c_cr2_itbufen, clearBit i2c_cr2_itevten, clearBit i2c_cr2_iterren */
            ;
            ivory_hw_io_write_u16((uint32_t) 1073764356U, (uint16_t) ((uint16_t) ((uint16_t) (n_cse37 & n_cse34) & n_cse31) & n_r5));
            
            uint8_t n_deref6 = i2c2_driverstate;
            
            i2c2_driverstate = (uint8_t) 0U;
            i2c2_resbuffer.resultcode = (uint8_t) 1U;
            
            uint32_t n_deref7 = i2c2_error_run;
            
            i2c2_error_run = (uint32_t) ((uint32_t) 1U + n_deref7);
            emitter_i2c2_request_chan_191(&i2c2_resbuffer);
        } else {
            /* reg set i2c2->cr1: setBit i2c_cr1_pe */
            ;
            ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) ((uint16_t) 1U << 0));
            i2c2_driverstate = (uint8_t) 1U;
            i2c2_reqbuffer = *n_var0;
            i2c2_reqbufferpos = (int32_t) 0;
            i2c2_resbufferpos = (int32_t) 0;
            
            int64_t n_r8 = tower_get_time();
            
            i2c2_last_event = n_r8;
            
            uint16_t n_r9 = ivory_hw_io_read_u16((uint32_t) 1073764356U);
            
            /* reg modify i2c2->cr2: setBit i2c_cr2_itbufen, setBit i2c_cr2_itevten, setBit i2c_cr2_iterren */
            ;
            
            uint16_t n_cse73 = (uint16_t) ((uint16_t) 1U << (uint16_t) 8U);
            
            ivory_hw_io_write_u16((uint32_t) 1073764356U, (uint16_t) ((uint16_t) ((uint16_t) (n_cse73 | (uint16_t) ((uint16_t) 1U << (uint16_t) 9U)) | (uint16_t) ((uint16_t) 1U << (uint16_t) 10U)) | n_r9));
            
            uint16_t n_r10 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
            
            /* reg modify i2c2->cr1: setBit i2c_cr1_start */
            ;
            ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse73 | n_r10));
            for (int32_t n_ix11 = (int32_t) 14; n_ix11 >= (int32_t) 0; n_ix11--) {
                /* reg get i2c2->cr1:  */
                ;
                
                uint16_t n_r12 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
                
                if ((bool) (0 == (uint8_t) (uint16_t) ((uint16_t) (n_r12 >> (uint16_t) 8U) & (uint16_t) 1U))) {
                    break;
                }
            }
        }
    } else {
        uint32_t n_deref13 = i2c2_invalid_request;
        
        i2c2_invalid_request = (uint32_t) ((uint32_t) 1U + n_deref13);
        
        uint16_t n_r14 = ivory_hw_io_read_u16((uint32_t) 1073764372U);
        
        /* reg modify i2c2->sr1: clearBit i2c_sr1_smbalert, clearBit i2c_sr1_timeout, clearBit i2c_sr1_pecerr, clearBit i2c_sr1_ovr, clearBit i2c_sr1_af, clearBit i2c_sr1_arlo, clearBit i2c_sr1_berr, clearBit i2c_sr1_txe, clearBit i2c_sr1_rxne, clearBit i2c_sr1_stopf, clearBit i2c_sr1_add10, clearBit i2c_sr1_btf, clearBit i2c_sr1_addr, clearBit i2c_sr1_sb */
        ;
        
        uint16_t n_cse112 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 8U);
        uint16_t n_cse114 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 9U);
        uint16_t n_cse116 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 10U);
        
        ivory_hw_io_write_u16((uint32_t) 1073764372U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ~(uint16_t) ((uint16_t) 1U << 0) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 1U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 2U)) &
                                                                                                                                                                                                      (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 3U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 4U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 6U)) &
                                                                                                                                                                  (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 7U)) & n_cse112) & n_cse114) & n_cse116) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 11U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 12U)) &
                                                                                          (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 14U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 15U)) & n_r14));
        
        uint16_t n_r15 = ivory_hw_io_read_u16((uint32_t) 1073764356U);
        
        /* reg modify i2c2->cr2: clearBit i2c_cr2_itbufen, clearBit i2c_cr2_itevten, clearBit i2c_cr2_iterren */
        ;
        ivory_hw_io_write_u16((uint32_t) 1073764356U, (uint16_t) ((uint16_t) ((uint16_t) (n_cse112 & n_cse114) & n_cse116) & n_r15));
        
        uint8_t n_deref16 = i2c2_driverstate;
        
        i2c2_driverstate = (uint8_t) 0U;
        i2c2_resbuffer.resultcode = (uint8_t) 1U;
        
        uint32_t n_deref17 = i2c2_error_run;
        
        i2c2_error_run = (uint32_t) ((uint32_t) 1U + n_deref17);
        emitter_i2c2_request_chan_191(&i2c2_resbuffer);
    }
}

void callback_i2c2_init_thread_init(const int64_t *n_var0)
{
    uint32_t n_r0 = ivory_hw_io_read_u32((uint32_t) 1073887296U);
    
    /* reg modify rcc_apb1enr: setBit rcc_apb1en_i2c2 */
    ivory_hw_io_write_u32((uint32_t) 1073887296U, (uint32_t) (n_r0 | (uint32_t) ((uint32_t) 1U << (uint32_t) 22U)));
    
    uint32_t n_r1 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiob */
    ;
    
    uint32_t n_cse4 = (uint32_t) ((uint32_t) 1U << (uint32_t) 1U);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r1 | n_cse4));
    
    uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073873924U);
    
    /* reg modify gpioB->otype: setField gpio_otype_11 */
    ;
    
    uint32_t n_cse12 = (uint32_t) (uint8_t) ((uint8_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073873924U, (uint32_t) ((uint32_t) (n_r2 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 11U)) | (uint32_t) (n_cse12 << (uint32_t) 11U)));
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073873932U);
    
    /* reg modify gpioB->pupd: setField gpio_pupd_11 */
    ;
    
    uint32_t n_cse17 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 22U);
    
    ivory_hw_io_write_u32((uint32_t) 1073873932U, (uint32_t) ((uint32_t) (n_r3 & n_cse17) | (uint32_t) (0 << (uint32_t) 22U)));
    
    uint32_t n_r4 = ivory_hw_io_read_u32((uint32_t) 1073873956U);
    
    /* reg modify gpioB->afrh: setField gpio_afrh_11 */
    ;
    
    uint32_t n_cse28 = (uint32_t) (uint8_t) ((uint8_t) 4U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073873956U, (uint32_t) ((uint32_t) (n_r4 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 12U)) | (uint32_t) (n_cse28 << (uint32_t) 12U)));
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073873920U);
    
    /* reg modify gpioB->mode: setField gpio_mode_11 */
    ;
    
    uint32_t n_cse35 = (uint32_t) (uint8_t) ((uint8_t) 2U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073873920U, (uint32_t) ((uint32_t) (n_cse17 & n_r5) | (uint32_t) (n_cse35 << (uint32_t) 22U)));
    
    uint32_t n_r6 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiob */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse4 | n_r6));
    
    uint32_t n_r7 = ivory_hw_io_read_u32((uint32_t) 1073873924U);
    
    /* reg modify gpioB->otype: setField gpio_otype_10 */
    ivory_hw_io_write_u32((uint32_t) 1073873924U, (uint32_t) ((uint32_t) (n_r7 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 10U)) | (uint32_t) (n_cse12 << (uint32_t) 10U)));
    
    uint32_t n_r8 = ivory_hw_io_read_u32((uint32_t) 1073873932U);
    
    /* reg modify gpioB->pupd: setField gpio_pupd_10 */
    ;
    
    uint32_t n_cse48 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 20U);
    
    ivory_hw_io_write_u32((uint32_t) 1073873932U, (uint32_t) ((uint32_t) (n_r8 & n_cse48) | (uint32_t) (0 << (uint32_t) 20U)));
    
    uint32_t n_r9 = ivory_hw_io_read_u32((uint32_t) 1073873956U);
    
    /* reg modify gpioB->afrh: setField gpio_afrh_10 */
    ivory_hw_io_write_u32((uint32_t) 1073873956U, (uint32_t) ((uint32_t) (n_r9 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 8U)) | (uint32_t) (n_cse28 << (uint32_t) 8U)));
    
    uint32_t n_r10 = ivory_hw_io_read_u32((uint32_t) 1073873920U);
    
    /* reg modify gpioB->mode: setField gpio_mode_10 */
    ivory_hw_io_write_u32((uint32_t) 1073873920U, (uint32_t) ((uint32_t) (n_cse48 & n_r10) | (uint32_t) (n_cse35 << (uint32_t) 20U)));
    /* reg set i2c2->cr1:  */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, 0);
    /* reg set i2c2->cr2:  */
    ivory_hw_io_write_u16((uint32_t) 1073764356U, 0);
    /* reg set i2c2->sr1:  */
    ivory_hw_io_write_u16((uint32_t) 1073764372U, 0);
    /* reg set i2c2->sr2:  */
    ivory_hw_io_write_u16((uint32_t) 1073764376U, 0);
    
    uint16_t n_r11 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ;
    
    uint16_t n_cse64 = (uint16_t) ((uint16_t) 1U << (uint16_t) 15U);
    
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_r11 | n_cse64));
    
    uint16_t n_r12 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r12));
    
    uint16_t n_r13 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r13));
    
    uint16_t n_r14 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r14));
    
    uint16_t n_r15 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r15));
    
    uint16_t n_r16 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r16));
    
    uint16_t n_r17 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r17));
    
    uint16_t n_r18 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r18));
    
    uint16_t n_r19 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r19));
    
    uint16_t n_r20 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r20));
    
    uint16_t n_r21 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r21));
    
    uint16_t n_r22 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r22));
    
    uint16_t n_r23 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r23));
    
    uint16_t n_r24 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r24));
    
    uint16_t n_r25 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r25));
    
    uint16_t n_r26 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r26));
    
    uint16_t n_r27 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r27));
    
    uint16_t n_r28 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r28));
    
    uint16_t n_r29 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r29));
    
    uint16_t n_r30 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r30));
    
    uint16_t n_r31 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r31));
    
    uint16_t n_r32 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r32));
    
    uint16_t n_r33 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r33));
    
    uint16_t n_r34 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r34));
    
    uint16_t n_r35 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r35));
    
    uint16_t n_r36 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r36));
    
    uint16_t n_r37 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r37));
    
    uint16_t n_r38 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r38));
    
    uint16_t n_r39 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r39));
    
    uint16_t n_r40 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r40));
    
    uint16_t n_r41 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r41));
    
    uint16_t n_r42 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_cse64 | n_r42));
    
    uint16_t n_r43 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: clearBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_r43 & (uint16_t) ~n_cse64));
    
    uint16_t n_r44 = ivory_hw_io_read_u16((uint32_t) 1073764356U);
    
    /* reg modify i2c2->cr2: setField i2c_cr2_freq */
    ivory_hw_io_write_u16((uint32_t) 1073764356U, (uint16_t) ((uint16_t) (n_r44 & (uint16_t) ~(uint16_t) ((uint16_t) 63U << 0)) | (uint16_t) ((uint16_t) 42U << 0)));
    
    uint16_t n_r45 = ivory_hw_io_read_u16((uint32_t) 1073764356U);
    
    /* reg modify i2c2->cr2: setBit i2c_cr2_itbufen, setBit i2c_cr2_itevten, setBit i2c_cr2_iterren */
    ivory_hw_io_write_u16((uint32_t) 1073764356U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) 1U << (uint16_t) 10U) | n_r45) | (uint16_t) ((uint16_t) 1U << (uint16_t) 9U)) | (uint16_t) ((uint16_t) 1U << (uint16_t) 8U)));
    
    uint16_t n_let47 = (uint16_t) ((bool) ((uint32_t) 4U <= (uint32_t) UINT16_MAX) ? (uint16_t) 4U : 0);
    uint16_t n_let48 = (uint16_t) ((bool) (n_let47 < (uint16_t) 1U) ? (uint16_t) 1U : n_let47);
    uint16_t n_r49 = ivory_hw_io_read_u16((uint32_t) 1073764380U);
    
    /* reg modify i2c2->ccr: setBit i2c_ccr_fastmode, setBit i2c_ccr_duty, setField i2c_ccr_ccr */
    ivory_hw_io_write_u16((uint32_t) 1073764380U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) (n_cse64 | n_r49) | (uint16_t) ((uint16_t) 1U << (uint16_t) 14U)) & (uint16_t) ~(uint16_t) ((uint16_t) 4095U << 0)) | (uint16_t) ((uint16_t) (n_let48 & (uint16_t) 4095U) << 0)));
    
    uint16_t n_r50 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_pe */
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) ((uint16_t) ((uint16_t) 1U << 0) | n_r50));
    /* reg set nvic_iser1: setBit nvic_iser_setena.[1] */
    ivory_hw_io_write_u32((uint32_t) 3758153988U, n_cse4);
    /* reg set nvic_iser1: setBit nvic_iser_setena.[2] */
    ivory_hw_io_write_u32((uint32_t) 3758153988U, (uint32_t) ((uint32_t) 1U << (uint32_t) 2U));
}

void callback_dmauart_rx_init_thread_init(const int64_t *n_var0)
{
    /* reg set dma1->s2par: setField dma_sxpar_par */
    ivory_hw_io_write_u32((uint32_t) 1073897544U, (uint32_t) ((uint32_t) 1073761284U << 0));
    
    uint32_t n_r0 = ref_to_uint32(&uart4_dma_rx0_buf.ivory_string_GPSString_data[(int32_t) 0]);
    
    /* reg set dma1->s2m0ar: setField dma_sxm0ar_m0a */
    ivory_hw_io_write_u32((uint32_t) 1073897548U, (uint32_t) (n_r0 << 0));
    
    uint32_t n_r1 = ref_to_uint32(&uart4_dma_rx1_buf.ivory_string_GPSString_data[(int32_t) 0]);
    
    /* reg set dma1->s2m1ar: setField dma_sxm1ar_m1a */
    ivory_hw_io_write_u32((uint32_t) 1073897552U, (uint32_t) (n_r1 << 0));
    /* reg set dma1->s2ndtr: setField dma_sxndtr_ndt */
    ivory_hw_io_write_u32((uint32_t) 1073897540U, (uint32_t) ((uint32_t) 127U << 0));
    
    uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073897556U);
    
    /* reg modify dma1->s2fcr: setBit dma_sxfcr_dmdis, setField dma_sxfcr_fth */
    ;
    
    uint32_t n_cse27 = (uint32_t) ((uint32_t) 1U << (uint32_t) 2U);
    
    ivory_hw_io_write_u32((uint32_t) 1073897556U, (uint32_t) ((uint32_t) ((uint32_t) (n_r2 | n_cse27) & (uint32_t) ~(uint32_t) ((uint32_t) 3U << 0)) | (uint32_t) ((uint32_t) 3U << 0)));
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073897536U);
    
    /* reg modify dma1->s2cr: setField dma_sxcr_chsel, setField dma_sxcr_mburst, setField dma_sxcr_pburst, setField dma_sxcr_ct, setField dma_sxcr_dbm, setField dma_sxcr_pl, setField dma_sxcr_msize, setField dma_sxcr_psize, setField dma_sxcr_minc, setField dma_sxcr_pinc, setField dma_sxcr_circ, setField dma_sxcr_dir, setField dma_sxcr_pfctrl, setField dma_sxcr_tcie, setField dma_sxcr_htie, setField dma_sxcr_teie, setField dma_sxcr_dmeie */
    ;
    
    uint32_t n_cse47 = (uint32_t) 0;
    uint32_t n_cse59 = (uint32_t) 0;
    
    ivory_hw_io_write_u32((uint32_t) 1073897536U,
                          (uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) (n_r3 &
                                                                                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 7U <<
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (uint32_t) 25U)) |
                                                                                                                                                                                                                                                                                                                                                                                                                                      (uint32_t) ((uint32_t) 4U <<
                                                                                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) 25U)) &
                                                                                                                                                                                                                                                                                                                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 3U <<
                                                                                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) 23U)) |
                                                                                                                                                                                                                                                                                                                                                                                                              (uint32_t) (n_cse47 <<
                                                                                                                                                                                                                                                                                                                                                                                                                          (uint32_t) 23U)) &
                                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 3U <<
                                                                                                                                                                                                                                                                                                                                                                                                                          (uint32_t) 21U)) |
                                                                                                                                                                                                                                                                                                                                                                                      (uint32_t) (n_cse47 <<
                                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) 21U)) &
                                                                                                                                                                                                                                                                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 1U <<
                                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) 19U)) |
                                                                                                                                                                                                                                                                                                                                                              (uint32_t) (n_cse59 << (uint32_t) 19U)) &
                                                                                                                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 18U)) |
                                                                                                                                                                                                                                                                                                                                      (uint32_t) ((uint32_t) 1U << (uint32_t) 18U)) &
                                                                                                                                                                                                                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 16U)) | (uint32_t) (n_cse47 <<
                                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) 16U)) &
                                                                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 13U)) | (uint32_t) (n_cse47 << (uint32_t) 13U)) &
                                                                                                                                                                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 11U)) | (uint32_t) (n_cse47 << (uint32_t) 11U)) &
                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 10U)) | (uint32_t) ((uint32_t) 1U << (uint32_t) 10U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U <<
                                                                                                                                                                                                                                                                                                                                                                                      (uint32_t) 9U)) |
                                                                                                                                                                                                              (uint32_t) (n_cse59 << (uint32_t) 9U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 8U)) | (uint32_t) (n_cse59 << (uint32_t) 8U)) & (uint32_t) ~(uint32_t) ((uint32_t) 3U <<
                                                                                                                                                                                                                                                                                                                                                                                   (uint32_t) 6U)) |
                                                                                                                                                              (uint32_t) (n_cse47 << (uint32_t) 6U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 5U)) | (uint32_t) (n_cse59 << (uint32_t) 5U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 4U)) | (uint32_t) ((uint32_t) 1U <<
                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) 4U)) &
                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 3U)) | (uint32_t) (n_cse59 << (uint32_t) 3U)) & (uint32_t) ~n_cse27) | (uint32_t) ((uint32_t) 1U << (uint32_t) 2U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 1U)) | (uint32_t) ((uint32_t) 1U << (uint32_t) 1U)));
    
    uint16_t n_r4 = ivory_hw_io_read_u16((uint32_t) 1073761300U);
    
    /* reg modify uart4->cr3: setField uart_cr3_dmar */
    ivory_hw_io_write_u16((uint32_t) 1073761300U, (uint16_t) ((uint16_t) (n_r4 & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 6U)) | (uint16_t) ((uint16_t) 1U << (uint16_t) 6U)));
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073897536U);
    
    /* reg modify dma1->s2cr: setField dma_sxcr_en */
    ivory_hw_io_write_u32((uint32_t) 1073897536U, (uint32_t) ((uint32_t) (n_r5 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << 0)) | (uint32_t) ((uint32_t) 1U << 0)));
    /* reg set nvic_iser0: setBit nvic_iser_setena.[13] */
    ivory_hw_io_write_u32((uint32_t) 3758153984U, (uint32_t) ((uint32_t) 1U << (uint32_t) 13U));
}

void callback_dmauart_tx_init_thread_init(const int64_t *n_var0)
{
    /* reg set nvic_iser0: setBit nvic_iser_setena.[15] */
    ivory_hw_io_write_u32((uint32_t) 3758153984U, (uint32_t) ((uint32_t) 1U << (uint32_t) 15U));
    uart4_dma_tx_active = false;
}

void callback_dmauart_hw_init_thread_init(const int64_t *n_var0)
{
    uint32_t n_r0 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_dma1 */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r0 | (uint32_t) ((uint32_t) 1U << (uint32_t) 21U)));
    
    uint32_t n_r1 = ivory_hw_io_read_u32((uint32_t) 1073887296U);
    
    /* reg modify rcc_apb1enr: setBit rcc_apb1en_uart4 */
    ivory_hw_io_write_u32((uint32_t) 1073887296U, (uint32_t) (n_r1 | (uint32_t) ((uint32_t) 1U << (uint32_t) 19U)));
    
    uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioa */
    ;
    
    uint32_t n_cse7 = (uint32_t) ((uint32_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r2 | n_cse7));
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073872904U);
    
    /* reg modify gpioA->ospeed: setField gpio_ospeed_0 */
    ;
    
    uint32_t n_cse11 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << 0);
    uint32_t n_cse15 = (uint32_t) (uint8_t) ((uint8_t) 2U << 0);
    uint32_t n_cse16 = (uint32_t) (n_cse15 << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073872904U, (uint32_t) ((uint32_t) (n_r3 & n_cse11) | n_cse16));
    
    uint32_t n_r4 = ivory_hw_io_read_u32((uint32_t) 1073872900U);
    
    /* reg modify gpioA->otype: setField gpio_otype_0 */
    ivory_hw_io_write_u32((uint32_t) 1073872900U, (uint32_t) ((uint32_t) (n_r4 & (uint32_t) ~n_cse7) | (uint32_t) (0 << 0)));
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073872908U);
    
    /* reg modify gpioA->pupd: setField gpio_pupd_0 */
    ;
    
    uint32_t n_cse28 = (uint32_t) (uint8_t) ((uint8_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073872908U, (uint32_t) ((uint32_t) (n_cse11 & n_r5) | (uint32_t) (n_cse28 << 0)));
    
    uint32_t n_r6 = ivory_hw_io_read_u32((uint32_t) 1073872928U);
    
    /* reg modify gpioA->afrl: setField gpio_afrl_0 */
    ;
    
    uint32_t n_cse37 = (uint32_t) (uint8_t) ((uint8_t) 8U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073872928U, (uint32_t) ((uint32_t) (n_r6 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << 0)) | (uint32_t) (n_cse37 << 0)));
    
    uint32_t n_r7 = ivory_hw_io_read_u32((uint32_t) 1073872896U);
    
    /* reg modify gpioA->mode: setField gpio_mode_0 */
    ivory_hw_io_write_u32((uint32_t) 1073872896U, (uint32_t) (n_cse16 | (uint32_t) (n_cse11 & n_r7)));
    
    uint32_t n_r8 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioa */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse7 | n_r8));
    
    uint32_t n_r9 = ivory_hw_io_read_u32((uint32_t) 1073872904U);
    
    /* reg modify gpioA->ospeed: setField gpio_ospeed_1 */
    ;
    
    uint32_t n_cse47 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 2U);
    uint32_t n_cse49 = (uint32_t) (n_cse15 << (uint32_t) 2U);
    
    ivory_hw_io_write_u32((uint32_t) 1073872904U, (uint32_t) ((uint32_t) (n_r9 & n_cse47) | n_cse49));
    
    uint32_t n_r10 = ivory_hw_io_read_u32((uint32_t) 1073872900U);
    
    /* reg modify gpioA->otype: setField gpio_otype_1 */
    ivory_hw_io_write_u32((uint32_t) 1073872900U, (uint32_t) ((uint32_t) (n_r10 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 1U)) | (uint32_t) (0 << (uint32_t) 1U)));
    
    uint32_t n_r11 = ivory_hw_io_read_u32((uint32_t) 1073872908U);
    
    /* reg modify gpioA->pupd: setField gpio_pupd_1 */
    ivory_hw_io_write_u32((uint32_t) 1073872908U, (uint32_t) ((uint32_t) (n_cse47 & n_r11) | (uint32_t) (n_cse28 << (uint32_t) 2U)));
    
    uint32_t n_r12 = ivory_hw_io_read_u32((uint32_t) 1073872928U);
    
    /* reg modify gpioA->afrl: setField gpio_afrl_1 */
    ivory_hw_io_write_u32((uint32_t) 1073872928U, (uint32_t) ((uint32_t) (n_r12 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 4U)) | (uint32_t) (n_cse37 << (uint32_t) 4U)));
    
    uint32_t n_r13 = ivory_hw_io_read_u32((uint32_t) 1073872896U);
    
    /* reg modify gpioA->mode: setField gpio_mode_1 */
    ivory_hw_io_write_u32((uint32_t) 1073872896U, (uint32_t) (n_cse49 | (uint32_t) (n_cse47 & n_r13)));
    /* reg get uart4->cr1:  */
    ;
    
    uint16_t n_r15 = ivory_hw_io_read_u16((uint32_t) 1073761292U);
    bool n_let16 = (bool) (0 != (uint8_t) (uint16_t) ((uint16_t) (n_r15 >> (uint16_t) 15U) & (uint16_t) 1U));
    uint32_t n_cse79 = (uint32_t) ((uint32_t) 38400U * (uint32_t) (n_let16 ? (uint32_t) 2U : (uint32_t) 4U));
    uint32_t n_cse83 = (uint32_t) ((uint32_t) 1050000000U / n_cse79);
    uint32_t n_cse91 = (uint32_t) (n_cse83 / (uint32_t) 100U);
    uint32_t n_let18 = (uint32_t) (n_cse91 << (uint32_t) 4U);
    uint32_t n_let19 = (uint32_t) (n_cse83 - (uint32_t) ((uint32_t) 100U * (uint32_t) (n_let18 >> (uint32_t) 4U)));
    uint32_t n_cse101 = (uint32_t) ((uint32_t) ((uint32_t) 8U * n_let19) + (uint32_t) 50U);
    uint32_t n_cse104 = (uint32_t) (n_cse101 / (uint32_t) 100U);
    uint32_t n_cse111 = (uint32_t) ((uint32_t) 50U + (uint32_t) (n_let19 * (uint32_t) 16U));
    uint32_t n_cse114 = (uint32_t) (n_cse111 / (uint32_t) 100U);
    uint32_t n_let20 = (uint32_t) (n_let18 | (uint32_t) (n_let16 ? (uint32_t) (n_cse104 & (uint32_t) 7U) : (uint32_t) (n_cse114 & (uint32_t) 15U)));
    
    /* reg set uart4->brr: setField uart_brr_div */
    ivory_hw_io_write_u16((uint32_t) 1073761288U, (uint16_t) ((uint16_t) (uint32_t) (n_let20 & (uint32_t) 65535U) << 0));
    
    uint16_t n_r21 = ivory_hw_io_read_u16((uint32_t) 1073761296U);
    
    /* reg modify uart4->cr2: setField uart_cr2_stop */
    ;
    
    uint16_t n_cse136 = (uint16_t) (0 << (uint16_t) 12U);
    
    ivory_hw_io_write_u16((uint32_t) 1073761296U, (uint16_t) ((uint16_t) (n_r21 & (uint16_t) ~(uint16_t) ((uint16_t) 3U << (uint16_t) 12U)) | n_cse136));
    
    uint16_t n_r22 = ivory_hw_io_read_u16((uint32_t) 1073761292U);
    
    /* reg modify uart4->cr1: setField uart_cr1_m */
    ivory_hw_io_write_u16((uint32_t) 1073761292U, (uint16_t) (n_cse136 | (uint16_t) (n_r22 & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 12U))));
    
    uint16_t n_r23 = ivory_hw_io_read_u16((uint32_t) 1073761292U);
    
    /* reg modify uart4->cr1: setField uart_cr1_pce */
    ivory_hw_io_write_u16((uint32_t) 1073761292U, (uint16_t) ((uint16_t) (n_r23 & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 10U)) | (uint16_t) ((uint16_t) 0 << (uint16_t) 10U)));
    /* reg set nvic_iser1: setBit nvic_iser_setena.[20] */
    ivory_hw_io_write_u32((uint32_t) 3758153988U, (uint32_t) ((uint32_t) 1U << (uint32_t) 20U));
    
    uint16_t n_r24 = ivory_hw_io_read_u16((uint32_t) 1073761292U);
    
    /* reg modify uart4->cr1: setBit uart_cr1_te, setBit uart_cr1_re */
    ivory_hw_io_write_u16((uint32_t) 1073761292U, (uint16_t) ((uint16_t) (n_r24 | (uint16_t) ((uint16_t) 1U << (uint16_t) 3U)) | (uint16_t) ((uint16_t) 1U << (uint16_t) 2U)));
    
    uint16_t n_r25 = ivory_hw_io_read_u16((uint32_t) 1073761292U);
    
    /* reg modify uart4->cr1: setBit uart_cr1_ue */
    ivory_hw_io_write_u16((uint32_t) 1073761292U, (uint16_t) (n_r25 | (uint16_t) ((uint16_t) 1U << (uint16_t) 13U)));
    emitter_dmauart_hw_init_chan_151(n_var0);
}

void callback_new_state_thread_init(const struct AhrsMlkf *n_var0)
{
    const float *n_cse0 = n_var0->ltp_to_imu_quat;
    float n_deref0 = n_cse0[(int32_t) 0];
    float n_deref1 = n_cse0[(int32_t) 1];
    float n_deref2 = n_cse0[(int32_t) 2];
    float n_deref3 = n_cse0[(int32_t) 3];
    const float *n_cse9 = n_var0->lp_rates;
    float n_deref4 = n_cse9[(int32_t) 0];
    float n_deref5 = n_cse9[(int32_t) 1];
    float n_deref6 = n_cse9[(int32_t) 2];
    const struct xyz *n_cse16 = &last_accel.sample;
    float n_deref7 = n_cse16->x;
    float n_deref8 = n_cse16->y;
    float n_deref9 = n_cse16->z;
    bool n_deref10 = last_accel.samplefail;
    bool n_deref11 = last_mag.samplefail;
    int64_t n_deref12 = last_baro.time;
    float n_deref13 = last_baro.pressure;
    bool n_deref14 = last_baro.samplefail;
    int64_t n_deref15 = last_gyro.time;
    bool n_deref16 = last_gyro.samplefail;
    float n_deref17 = last_lidar.distance;
    int64_t n_deref18 = last_lidar.time;
    bool n_deref19 = last_lidar.samplefail;
    bool n_let20 = (bool) ((bool) !n_deref10 && (bool) ((bool) !n_deref11 && (bool) ((bool) !n_deref14 && (bool) ((bool) !n_deref16 && (bool) !n_deref19))));
    bool n_let21 = (bool) ((bool) (n_deref0 != 0.0f) || (bool) ((bool) (0.0f != n_deref1) || (bool) ((bool) (0.0f != n_deref2) || (bool) (0.0f != n_deref3))));
    float n_cse52 = (float) (n_deref2 * n_deref2);
    struct sensors_result n_local22 = {.valid =(bool) (n_let20 && n_let21), .roll =(float) atan2f((float) (2.0f * (float) ((float) (n_deref0 * n_deref1) + (float) (n_deref2 * n_deref3))), (float) (1.0f - (float) (2.0f * (float) ((float) (n_deref1 * n_deref1) + n_cse52)))), .pitch =(float) asinf((float) (2.0f * (float) ((float) (n_deref0 * n_deref2) - (float) (n_deref1 * n_deref3)))), .yaw =
                                       (float) atan2f((float) (2.0f * (float) ((float) (n_deref0 * n_deref3) + (float) (n_deref1 * n_deref2))), (float) (1.0f - (float) (2.0f * (float) (n_cse52 + (float) (n_deref3 * n_deref3))))), .omega ={.x =n_deref4, .y =n_deref5, .z =n_deref6}, .attitude ={.quat_a =n_deref0, .quat_b =n_deref1, .quat_c =n_deref2, .quat_d =n_deref3}, .baro_alt =
                                       (float) ((float) ((float) (288.15f / (float) powf((float) ((float) (n_deref13 * 100.0f) / 101325.0f), (float) (-5.4043077e-2f / 0.28404373f))) - 288.15f) / -6.5e-3f), .lidar_alt =n_deref17, .accel ={.x =n_deref7, .y =n_deref8, .z =n_deref9}, .ahrs_time =n_deref15, .baro_time =n_deref12, .lidar_time =n_deref18};
    struct sensors_result *n_ref23 = &n_local22;
    
    emitter_new_state_chan_29(n_ref23);
}

void callback_save_last_gyro_thread_init(const struct gyroscope_sample *n_var0)
{
    last_gyro = *n_var0;
}

void callback_save_last_baro_thread_init(const struct barometer_sample *n_var0)
{
    last_baro = *n_var0;
}

void callback_save_last_mag_thread_init(const struct magnetometer_sample *n_var0)
{
    last_mag = *n_var0;
}

void callback_save_last_accel_thread_init(const struct accelerometer_sample *n_var0)
{
    last_accel = *n_var0;
}

void callback_att_est_motion_thread_init(const bool *n_var0)
{
    in_motion = *n_var0;
}

void callback_att_est_gyro_thread_init(const struct gyroscope_sample *n_var0)
{
    bool n_deref0 = n_var0->samplefail;
    
    if ((bool) !n_deref0) {
        att_est_last_gyro_rads = *n_var0;
        
        bool n_deref1 = att_est_aligned;
        
        if (n_deref1) {
            int64_t n_deref2 = att_est_last_gyro_time;
            int64_t n_r3 = tower_get_time();
            
            att_est_last_gyro_time = n_r3;
            
            int64_t n_cse1 = (int64_t) (n_r3 - n_deref2);
            int64_t n_cse5 = (int64_t) (n_cse1 / (int64_t) 1000);
            int64_t n_cse9 = (int64_t) ((bool) ((int64_t) (n_cse1 % (int64_t) 1000) < (int64_t) 0) ? (int64_t) (n_cse5 - (int64_t) 1) : n_cse5);
            
            att_est_ahrs_mlkf_propagate(&att_est_last_gyro_rads, (float) ((float) (int16_t) ((bool) ((bool) (n_cse9 <= (int64_t) INT16_MAX) && (bool) (n_cse9 >= (int64_t) INT16_MIN)) ? (int16_t) n_cse9 : (int16_t) 0) / 1000.0f));
            emitter_att_est_gyro_chan_189(&att_est_ahrs_state);
        } else {
            bool n_deref4 = in_motion;
            
            if ((bool) !n_deref4) {
                bool n_r5 = att_est_ahrs_mlkf_align(&att_est_last_gyro_rads, &att_est_last_acc, &att_est_last_mag);
                
                if (n_r5) {
                    att_est_aligned = true;
                }
            }
        }
    }
}

void callback_att_est_mag_thread_init(const struct magnetometer_sample *n_var0)
{
    bool n_deref0 = n_var0->samplefail;
    
    if ((bool) !n_deref0) {
        att_est_last_mag = *n_var0;
        
        bool n_deref1 = att_est_aligned;
        
        if (n_deref1) {
            att_est_mag_2d(n_var0);
            emitter_att_est_mag_chan_189(&att_est_ahrs_state);
        }
    }
}

void callback_att_est_accel_thread_init(const struct accelerometer_sample *n_var0)
{
    bool n_deref0 = n_var0->samplefail;
    
    if ((bool) !n_deref0) {
        att_est_last_acc = *n_var0;
        
        bool n_deref1 = att_est_aligned;
        
        if (n_deref1) {
            att_est_ahrs_mlkf_update_accel(n_var0);
            emitter_att_est_accel_chan_189(&att_est_ahrs_state);
        }
    }
}

void callback_att_est_init_thread_init(const int64_t *n_var0)
{
    att_est_init();
    
    int64_t n_r0 = tower_get_time();
    
    att_est_last_gyro_time = n_r0;
}

void callback_write_mag_output_attr_thread_init(const struct magnetometer_sample *n_var0)
{
    emitter_write_mag_output_attr_chan_34(n_var0);
}

void callback_write_gyro_output_attr_thread_init(const struct gyroscope_sample *n_var0)
{
    emitter_write_gyro_output_attr_chan_30(n_var0);
}

void callback_write_baro_output_attr_thread_init(const struct barometer_sample *n_var0)
{
    emitter_write_baro_output_attr_chan_32(n_var0);
}

void callback_write_accel_output_attr_thread_init(const struct accelerometer_sample *n_var0)
{
    emitter_write_accel_output_attr_chan_31(n_var0);
}

void callback_motion_light_debug_2_thread_init(const bool *n_var0)
{
    bool n_deref0 = *n_var0;
    struct rgb_led_setting n_local1 = {};
    struct rgb_led_setting *n_ref2 = &n_local1;
    
    if (n_deref0) {
        n_ref2->red = (uint8_t) 15U;
    } else {
        n_ref2->green = (uint8_t) 15U;
    }
    emitter_motion_light_debug_2_chan_23(n_ref2);
}

void callback_detectMotion_2_accel_thread_init(const struct accelerometer_sample *n_var0)
{
    const struct xyz *n_cse0 = &n_var0->sample;
    float n_deref0 = n_cse0->x;
    float n_deref1 = n_cse0->y;
    float n_deref2 = n_cse0->z;
    float n_let3 = (float) (n_deref0 / 2.5553503f);
    float n_deref4 = detectMotion_2_ax_butter_state_x1;
    float n_deref5 = detectMotion_2_ax_butter_state_x0;
    float n_deref6 = detectMotion_2_ax_butter_state_y1;
    float n_deref7 = detectMotion_2_ax_butter_state_y0;
    float n_let8 = (float) ((float) ((float) ((float) (n_let3 + (float) (-2.0f * n_deref5)) + n_deref4) + (float) (0.36952737f * n_deref7)) + (float) (-0.19481471f * n_deref6));
    
    detectMotion_2_ax_butter_state_x0 = n_let3;
    detectMotion_2_ax_butter_state_x1 = n_deref5;
    detectMotion_2_ax_butter_state_y0 = n_let8;
    detectMotion_2_ax_butter_state_y1 = n_deref7;
    
    float n_let9 = (float) (n_deref1 / 2.5553503f);
    float n_deref10 = detectMotion_2_ay_butter_state_x1;
    float n_deref11 = detectMotion_2_ay_butter_state_x0;
    float n_deref12 = detectMotion_2_ay_butter_state_y1;
    float n_deref13 = detectMotion_2_ay_butter_state_y0;
    float n_let14 = (float) ((float) ((float) ((float) (n_let9 + (float) (-2.0f * n_deref11)) + n_deref10) + (float) (0.36952737f * n_deref13)) + (float) (-0.19481471f * n_deref12));
    
    detectMotion_2_ay_butter_state_x0 = n_let9;
    detectMotion_2_ay_butter_state_x1 = n_deref11;
    detectMotion_2_ay_butter_state_y0 = n_let14;
    detectMotion_2_ay_butter_state_y1 = n_deref13;
    
    float n_let15 = (float) (n_deref2 / 2.5553503f);
    float n_deref16 = detectMotion_2_az_butter_state_x1;
    float n_deref17 = detectMotion_2_az_butter_state_x0;
    float n_deref18 = detectMotion_2_az_butter_state_y1;
    float n_deref19 = detectMotion_2_az_butter_state_y0;
    float n_let20 = (float) ((float) ((float) ((float) (n_let15 + (float) (-2.0f * n_deref17)) + n_deref16) + (float) (0.36952737f * n_deref19)) + (float) (-0.19481471f * n_deref18));
    
    detectMotion_2_az_butter_state_x0 = n_let15;
    detectMotion_2_az_butter_state_x1 = n_deref17;
    detectMotion_2_az_butter_state_y0 = n_let20;
    detectMotion_2_az_butter_state_y1 = n_deref19;
    
    float n_deref21 = detectMotion_2_ax_butter_state_y0;
    float n_deref22 = detectMotion_2_ay_butter_state_y0;
    float n_deref23 = detectMotion_2_az_butter_state_y0;
    float n_let24 = (float) ((float) ((float) ((float) (n_deref21 * n_deref21) + (float) (n_deref22 * n_deref22)) + (float) (n_deref23 * n_deref23)) - 96.17039f);
    
    if ((bool) (n_let24 > 0.25f)) {
        accel_threshold_counter = (uint32_t) 0U;
    } else {
        uint32_t n_deref25 = accel_threshold_counter;
        
        accel_threshold_counter = (uint32_t) (n_deref25 + (uint32_t) 1U);
    }
    
    uint32_t n_deref26 = accel_threshold_counter;
    uint32_t n_deref27 = gyro_threshold_counter;
    bool n_local28 = (bool) ((bool) (n_deref26 <= (uint32_t) 200U) || (bool) (n_deref27 <= (uint32_t) 200U));
    bool *n_ref29 = &n_local28;
    
    emitter_detectMotion_2_accel_chan_188(n_ref29);
}

void callback_detectMotion_2_gyro_thread_init(const struct gyroscope_sample *n_var0)
{
    const struct xyz *n_cse0 = &n_var0->sample;
    float n_deref0 = n_cse0->x;
    float n_deref1 = n_cse0->y;
    float n_deref2 = n_cse0->z;
    float n_let3 = (float) (n_deref0 / 2.5553503f);
    float n_deref4 = detectMotion_2_gx_butter_state_x1;
    float n_deref5 = detectMotion_2_gx_butter_state_x0;
    float n_deref6 = detectMotion_2_gx_butter_state_y1;
    float n_deref7 = detectMotion_2_gx_butter_state_y0;
    float n_let8 = (float) ((float) ((float) ((float) (n_let3 + (float) (-2.0f * n_deref5)) + n_deref4) + (float) (0.36952737f * n_deref7)) + (float) (-0.19481471f * n_deref6));
    
    detectMotion_2_gx_butter_state_x0 = n_let3;
    detectMotion_2_gx_butter_state_x1 = n_deref5;
    detectMotion_2_gx_butter_state_y0 = n_let8;
    detectMotion_2_gx_butter_state_y1 = n_deref7;
    
    float n_let9 = (float) (n_deref1 / 2.5553503f);
    float n_deref10 = detectMotion_2_gy_butter_state_x1;
    float n_deref11 = detectMotion_2_gy_butter_state_x0;
    float n_deref12 = detectMotion_2_gy_butter_state_y1;
    float n_deref13 = detectMotion_2_gy_butter_state_y0;
    float n_let14 = (float) ((float) ((float) ((float) (n_let9 + (float) (-2.0f * n_deref11)) + n_deref10) + (float) (0.36952737f * n_deref13)) + (float) (-0.19481471f * n_deref12));
    
    detectMotion_2_gy_butter_state_x0 = n_let9;
    detectMotion_2_gy_butter_state_x1 = n_deref11;
    detectMotion_2_gy_butter_state_y0 = n_let14;
    detectMotion_2_gy_butter_state_y1 = n_deref13;
    
    float n_let15 = (float) (n_deref2 / 2.5553503f);
    float n_deref16 = detectMotion_2_gz_butter_state_x1;
    float n_deref17 = detectMotion_2_gz_butter_state_x0;
    float n_deref18 = detectMotion_2_gz_butter_state_y1;
    float n_deref19 = detectMotion_2_gz_butter_state_y0;
    float n_let20 = (float) ((float) ((float) ((float) (n_let15 + (float) (-2.0f * n_deref17)) + n_deref16) + (float) (0.36952737f * n_deref19)) + (float) (-0.19481471f * n_deref18));
    
    detectMotion_2_gz_butter_state_x0 = n_let15;
    detectMotion_2_gz_butter_state_x1 = n_deref17;
    detectMotion_2_gz_butter_state_y0 = n_let20;
    detectMotion_2_gz_butter_state_y1 = n_deref19;
    
    float n_deref21 = detectMotion_2_gx_butter_state_y0;
    float n_deref22 = detectMotion_2_gy_butter_state_y0;
    float n_deref23 = detectMotion_2_gz_butter_state_y0;
    float n_let24 = (float) ((float) ((float) (n_deref21 * n_deref21) + (float) (n_deref22 * n_deref22)) + (float) (n_deref23 * n_deref23));
    
    if ((bool) (n_let24 > 0.25f)) {
        gyro_threshold_counter = (uint32_t) 0U;
    } else {
        uint32_t n_deref25 = gyro_threshold_counter;
        
        gyro_threshold_counter = (uint32_t) (n_deref25 + (uint32_t) 1U);
    }
}

void callback_detectMotion_2_init_thread_init(const int64_t *n_var0)
{
    detectMotion_2_gx_butter_state_x0 = 0.0f;
    detectMotion_2_gx_butter_state_x1 = 0.0f;
    detectMotion_2_gx_butter_state_y0 = 0.0f;
    detectMotion_2_gx_butter_state_y1 = 0.0f;
    detectMotion_2_gy_butter_state_x0 = 0.0f;
    detectMotion_2_gy_butter_state_x1 = 0.0f;
    detectMotion_2_gy_butter_state_y0 = 0.0f;
    detectMotion_2_gy_butter_state_y1 = 0.0f;
    detectMotion_2_gz_butter_state_x0 = 0.0f;
    detectMotion_2_gz_butter_state_x1 = 0.0f;
    detectMotion_2_gz_butter_state_y0 = 0.0f;
    detectMotion_2_gz_butter_state_y1 = 0.0f;
    detectMotion_2_ax_butter_state_x0 = 0.0f;
    detectMotion_2_ax_butter_state_x1 = 0.0f;
    detectMotion_2_ax_butter_state_y0 = 0.0f;
    detectMotion_2_ax_butter_state_y1 = 0.0f;
    detectMotion_2_ay_butter_state_x0 = 0.0f;
    detectMotion_2_ay_butter_state_x1 = 0.0f;
    detectMotion_2_ay_butter_state_y0 = 0.0f;
    detectMotion_2_ay_butter_state_y1 = 0.0f;
    detectMotion_2_az_butter_state_x0 = 0.0f;
    detectMotion_2_az_butter_state_x1 = 0.0f;
    detectMotion_2_az_butter_state_y0 = 0.0f;
    detectMotion_2_az_butter_state_y1 = 0.0f;
}

void callback_i2c1_init_thread_init(const int64_t *n_var0)
{
    uint32_t n_r0 = ivory_hw_io_read_u32((uint32_t) 1073887296U);
    
    /* reg modify rcc_apb1enr: setBit rcc_apb1en_i2c1 */
    ivory_hw_io_write_u32((uint32_t) 1073887296U, (uint32_t) (n_r0 | (uint32_t) ((uint32_t) 1U << (uint32_t) 21U)));
    
    uint32_t n_r1 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiob */
    ;
    
    uint32_t n_cse4 = (uint32_t) ((uint32_t) 1U << (uint32_t) 1U);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r1 | n_cse4));
    
    uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073873924U);
    
    /* reg modify gpioB->otype: setField gpio_otype_9 */
    ;
    
    uint32_t n_cse12 = (uint32_t) (uint8_t) ((uint8_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073873924U, (uint32_t) ((uint32_t) (n_r2 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 9U)) | (uint32_t) (n_cse12 << (uint32_t) 9U)));
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073873932U);
    
    /* reg modify gpioB->pupd: setField gpio_pupd_9 */
    ;
    
    uint32_t n_cse17 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 18U);
    
    ivory_hw_io_write_u32((uint32_t) 1073873932U, (uint32_t) ((uint32_t) (n_r3 & n_cse17) | (uint32_t) (0 << (uint32_t) 18U)));
    
    uint32_t n_r4 = ivory_hw_io_read_u32((uint32_t) 1073873956U);
    
    /* reg modify gpioB->afrh: setField gpio_afrh_9 */
    ;
    
    uint32_t n_cse28 = (uint32_t) (uint8_t) ((uint8_t) 4U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073873956U, (uint32_t) ((uint32_t) (n_r4 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 4U)) | (uint32_t) (n_cse28 << (uint32_t) 4U)));
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073873920U);
    
    /* reg modify gpioB->mode: setField gpio_mode_9 */
    ;
    
    uint32_t n_cse35 = (uint32_t) (uint8_t) ((uint8_t) 2U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073873920U, (uint32_t) ((uint32_t) (n_cse17 & n_r5) | (uint32_t) (n_cse35 << (uint32_t) 18U)));
    
    uint32_t n_r6 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiob */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse4 | n_r6));
    
    uint32_t n_r7 = ivory_hw_io_read_u32((uint32_t) 1073873924U);
    
    /* reg modify gpioB->otype: setField gpio_otype_8 */
    ivory_hw_io_write_u32((uint32_t) 1073873924U, (uint32_t) ((uint32_t) (n_r7 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 8U)) | (uint32_t) (n_cse12 << (uint32_t) 8U)));
    
    uint32_t n_r8 = ivory_hw_io_read_u32((uint32_t) 1073873932U);
    
    /* reg modify gpioB->pupd: setField gpio_pupd_8 */
    ;
    
    uint32_t n_cse48 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 16U);
    
    ivory_hw_io_write_u32((uint32_t) 1073873932U, (uint32_t) ((uint32_t) (n_r8 & n_cse48) | (uint32_t) (0 << (uint32_t) 16U)));
    
    uint32_t n_r9 = ivory_hw_io_read_u32((uint32_t) 1073873956U);
    
    /* reg modify gpioB->afrh: setField gpio_afrh_8 */
    ivory_hw_io_write_u32((uint32_t) 1073873956U, (uint32_t) ((uint32_t) (n_r9 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << 0)) | (uint32_t) (n_cse28 << 0)));
    
    uint32_t n_r10 = ivory_hw_io_read_u32((uint32_t) 1073873920U);
    
    /* reg modify gpioB->mode: setField gpio_mode_8 */
    ivory_hw_io_write_u32((uint32_t) 1073873920U, (uint32_t) ((uint32_t) (n_cse48 & n_r10) | (uint32_t) (n_cse35 << (uint32_t) 16U)));
    /* reg set i2c1->cr1:  */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, 0);
    /* reg set i2c1->cr2:  */
    ivory_hw_io_write_u16((uint32_t) 1073763332U, 0);
    /* reg set i2c1->sr1:  */
    ivory_hw_io_write_u16((uint32_t) 1073763348U, 0);
    /* reg set i2c1->sr2:  */
    ivory_hw_io_write_u16((uint32_t) 1073763352U, 0);
    
    uint16_t n_r11 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ;
    
    uint16_t n_cse64 = (uint16_t) ((uint16_t) 1U << (uint16_t) 15U);
    
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_r11 | n_cse64));
    
    uint16_t n_r12 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r12));
    
    uint16_t n_r13 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r13));
    
    uint16_t n_r14 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r14));
    
    uint16_t n_r15 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r15));
    
    uint16_t n_r16 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r16));
    
    uint16_t n_r17 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r17));
    
    uint16_t n_r18 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r18));
    
    uint16_t n_r19 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r19));
    
    uint16_t n_r20 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r20));
    
    uint16_t n_r21 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r21));
    
    uint16_t n_r22 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r22));
    
    uint16_t n_r23 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r23));
    
    uint16_t n_r24 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r24));
    
    uint16_t n_r25 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r25));
    
    uint16_t n_r26 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r26));
    
    uint16_t n_r27 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r27));
    
    uint16_t n_r28 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r28));
    
    uint16_t n_r29 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r29));
    
    uint16_t n_r30 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r30));
    
    uint16_t n_r31 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r31));
    
    uint16_t n_r32 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r32));
    
    uint16_t n_r33 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r33));
    
    uint16_t n_r34 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r34));
    
    uint16_t n_r35 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r35));
    
    uint16_t n_r36 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r36));
    
    uint16_t n_r37 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r37));
    
    uint16_t n_r38 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r38));
    
    uint16_t n_r39 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r39));
    
    uint16_t n_r40 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r40));
    
    uint16_t n_r41 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r41));
    
    uint16_t n_r42 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_cse64 | n_r42));
    
    uint16_t n_r43 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: clearBit i2c_cr1_swrst */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) (n_r43 & (uint16_t) ~n_cse64));
    
    uint16_t n_r44 = ivory_hw_io_read_u16((uint32_t) 1073763332U);
    
    /* reg modify i2c1->cr2: setField i2c_cr2_freq */
    ivory_hw_io_write_u16((uint32_t) 1073763332U, (uint16_t) ((uint16_t) (n_r44 & (uint16_t) ~(uint16_t) ((uint16_t) 63U << 0)) | (uint16_t) ((uint16_t) 42U << 0)));
    
    uint16_t n_r45 = ivory_hw_io_read_u16((uint32_t) 1073763332U);
    
    /* reg modify i2c1->cr2: setBit i2c_cr2_itbufen, setBit i2c_cr2_itevten, setBit i2c_cr2_iterren */
    ivory_hw_io_write_u16((uint32_t) 1073763332U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) 1U << (uint16_t) 8U) | (uint16_t) ((uint16_t) 1U << (uint16_t) 9U)) | n_r45) | (uint16_t) ((uint16_t) 1U << (uint16_t) 10U)));
    
    uint16_t n_let47 = (uint16_t) ((bool) ((uint32_t) 4U <= (uint32_t) UINT16_MAX) ? (uint16_t) 4U : 0);
    uint16_t n_let48 = (uint16_t) ((bool) (n_let47 < (uint16_t) 1U) ? (uint16_t) 1U : n_let47);
    uint16_t n_r49 = ivory_hw_io_read_u16((uint32_t) 1073763356U);
    
    /* reg modify i2c1->ccr: setBit i2c_ccr_fastmode, setBit i2c_ccr_duty, setField i2c_ccr_ccr */
    ivory_hw_io_write_u16((uint32_t) 1073763356U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) (n_cse64 | n_r49) | (uint16_t) ((uint16_t) 1U << (uint16_t) 14U)) & (uint16_t) ~(uint16_t) ((uint16_t) 4095U << 0)) | (uint16_t) ((uint16_t) (n_let48 & (uint16_t) 4095U) << 0)));
    
    uint16_t n_r50 = ivory_hw_io_read_u16((uint32_t) 1073763328U);
    
    /* reg modify i2c1->cr1: setBit i2c_cr1_pe */
    ivory_hw_io_write_u16((uint32_t) 1073763328U, (uint16_t) ((uint16_t) ((uint16_t) 1U << 0) | n_r50));
    /* reg set nvic_iser0: setBit nvic_iser_setena.[31] */
    ivory_hw_io_write_u32((uint32_t) 3758153984U, (uint32_t) ((uint32_t) 1U << (uint32_t) 31U));
    /* reg set nvic_iser1: setBit nvic_iser_setena.[0] */
    ivory_hw_io_write_u32((uint32_t) 3758153988U, (uint32_t) ((uint32_t) 1U << 0));
}

void callback_spi1_scheduler_ready_thread_init(const int64_t *n_var0)
{
    bool n_deref0 = spi1_scheduler_mpu6000_pending;
    bool n_deref1 = spi1_scheduler_lsm303d_pending;
    bool n_deref2 = spi1_scheduler_ms5611_pending;
    bool n_deref3 = spi1_scheduler_l3gd20_pending;
    
    if (n_deref0) {
        emitter_spi1_scheduler_ready_chan_158(&spi1_scheduler_mpu6000_last_req);
        spi1_scheduler_response_task = (uint32_t) 1U;
    } else {
        if (n_deref1) {
            emitter_spi1_scheduler_ready_chan_158(&spi1_scheduler_lsm303d_last_req);
            spi1_scheduler_response_task = (uint32_t) 2U;
        } else {
            if (n_deref2) {
                emitter_spi1_scheduler_ready_chan_158(&spi1_scheduler_ms5611_last_req);
                spi1_scheduler_response_task = (uint32_t) 3U;
            } else {
                if (n_deref3) {
                    emitter_spi1_scheduler_ready_chan_158(&spi1_scheduler_l3gd20_last_req);
                    spi1_scheduler_response_task = (uint32_t) 4U;
                } else {
                    spi1_scheduler_response_task = (uint32_t) 0U;
                }
            }
        }
    }
}

void callback_spi1_scheduler_l3gd20_thread_init(const struct spi_transaction_request *n_var0)
{
    bool n_deref0 = spi1_scheduler_l3gd20_pending;
    
    ASSERTS((bool) !n_deref0);
    spi1_scheduler_l3gd20_last_req = *n_var0;
    spi1_scheduler_l3gd20_pending = true;
    
    uint32_t n_deref1 = spi1_scheduler_response_task;
    
    if ((bool) (0 == n_deref1)) {
        spi1_scheduler_response_task = (uint32_t) 4U;
        emitter_spi1_scheduler_l3gd20_chan_158(&spi1_scheduler_l3gd20_last_req);
    }
}

void callback_spi1_scheduler_ms5611_thread_init(const struct spi_transaction_request *n_var0)
{
    bool n_deref0 = spi1_scheduler_ms5611_pending;
    
    ASSERTS((bool) !n_deref0);
    spi1_scheduler_ms5611_last_req = *n_var0;
    spi1_scheduler_ms5611_pending = true;
    
    uint32_t n_deref1 = spi1_scheduler_response_task;
    
    if ((bool) (0 == n_deref1)) {
        spi1_scheduler_response_task = (uint32_t) 3U;
        emitter_spi1_scheduler_ms5611_chan_158(&spi1_scheduler_ms5611_last_req);
    }
}

void callback_spi1_scheduler_lsm303d_thread_init(const struct spi_transaction_request *n_var0)
{
    bool n_deref0 = spi1_scheduler_lsm303d_pending;
    
    ASSERTS((bool) !n_deref0);
    spi1_scheduler_lsm303d_last_req = *n_var0;
    spi1_scheduler_lsm303d_pending = true;
    
    uint32_t n_deref1 = spi1_scheduler_response_task;
    
    if ((bool) (0 == n_deref1)) {
        spi1_scheduler_response_task = (uint32_t) 2U;
        emitter_spi1_scheduler_lsm303d_chan_158(&spi1_scheduler_lsm303d_last_req);
    }
}

void callback_spi1_scheduler_mpu6000_thread_init(const struct spi_transaction_request *n_var0)
{
    bool n_deref0 = spi1_scheduler_mpu6000_pending;
    
    ASSERTS((bool) !n_deref0);
    spi1_scheduler_mpu6000_last_req = *n_var0;
    spi1_scheduler_mpu6000_pending = true;
    
    uint32_t n_deref1 = spi1_scheduler_response_task;
    
    if ((bool) (0 == n_deref1)) {
        spi1_scheduler_response_task = (uint32_t) 1U;
        emitter_spi1_scheduler_mpu6000_chan_158(&spi1_scheduler_mpu6000_last_req);
    }
}

void callback_ms5611_init_thread_init(const int64_t *n_var0)
{
    bool n_local0 = true;
    bool *n_ref1 = &n_local0;
    
    emitter_ms5611_init_chan_178(n_ref1);
}

void callback_ms5611_thread_init(const bool *n_var0)
{
    bool n_deref0 = *n_var0;
    
    if (n_deref0) {
        ms5611_cont.state = (uint32_t) 16U;
    }
    {
        int forever_loop __attribute__((unused));
        
        for (forever_loop = 0; IFOREVER; IFOREVER_INC) {
            uint32_t n_state = ms5611_cont.state;
            
            if ((bool) ((uint32_t) 2U == n_state)) {
                ms5611_cont.r26 = last_value_4;
                
                const struct spi_transaction_result *n_cse5 = &ms5611_cont.r26;
                
                ms5611_cont.deref27 = n_cse5->resultcode;
                
                uint8_t n_cont25 = ms5611_cont.deref27;
                
                if ((bool) (n_cont25 > 0)) {
                    measurement.samplefail = true;
                }
                
                const uint8_t *n_cse11 = n_cse5->rx_buf;
                
                ms5611_cont.deref28 = n_cse11[(int32_t) 1];
                ms5611_cont.deref29 = n_cse11[(int32_t) 2];
                ms5611_cont.deref30 = n_cse11[(int32_t) 3];
                
                uint8_t n_cont4 = ms5611_cont.deref28;
                uint8_t n_cont5 = ms5611_cont.deref29;
                uint8_t n_cont6 = ms5611_cont.deref30;
                
                ms5611_cont.let31 = (uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) n_cont4 << (uint32_t) 16U) + (uint32_t) ((uint32_t) n_cont5 << (uint32_t) 8U)) + (uint32_t) n_cont6);
                
                uint32_t n_cont7 = ms5611_cont.let31;
                
                sample.sample_temperature = n_cont7;
                
                int64_t n_r32 = tower_get_time();
                
                ms5611_cont.r32 = n_r32;
                
                int64_t n_cont8 = ms5611_cont.r32;
                
                sample.sample_time = n_cont8;
                
                const uint16_t *n_cse37 = calibration.coeff;
                
                ms5611_cont.deref33 = n_cse37[(int32_t) 0];
                ms5611_cont.deref34 = n_cse37[(int32_t) 1];
                ms5611_cont.deref35 = n_cse37[(int32_t) 2];
                ms5611_cont.deref36 = n_cse37[(int32_t) 3];
                ms5611_cont.deref37 = n_cse37[(int32_t) 4];
                ms5611_cont.deref38 = n_cse37[(int32_t) 5];
                ms5611_cont.deref39 = sample.sample_pressure;
                ms5611_cont.deref40 = sample.sample_temperature;
                
                uint32_t n_cont9 = ms5611_cont.deref40;
                uint16_t n_cont10 = ms5611_cont.deref37;
                
                ms5611_cont.let41 = (int32_t) ((int32_t) ((bool) (n_cont9 <= (uint32_t) INT32_MAX) ? (int32_t) n_cont9 : (int32_t) 0) - (int32_t) ((int32_t) n_cont10 * (int32_t) 256));
                
                const int32_t *n_cse72 = &ms5611_cont.let41;
                int32_t n_cont11 = *n_cse72;
                uint16_t n_cont12 = ms5611_cont.deref38;
                int64_t n_cse77 = (int64_t) ((int64_t) n_cont11 * (int64_t) n_cont12);
                int64_t n_cse88 = (int64_t) (n_cse77 / (int64_t) 8388608);
                int64_t n_cse92 = (int64_t) ((bool) ((int64_t) (n_cse77 % (int64_t) 8388608) < (int64_t) 0) ? (int64_t) (n_cse88 - (int64_t) 1) : n_cse88);
                int64_t n_cse93 = (int64_t) INT32_MAX;
                int64_t n_cse95 = (int64_t) INT32_MIN;
                
                ms5611_cont.let42 = (int32_t) ((int32_t) 2000 + (int32_t) ((bool) ((bool) (n_cse92 <= n_cse93) && (bool) (n_cse92 >= n_cse95)) ? (int32_t) n_cse92 : (int32_t) 0));
                
                uint16_t n_cont13 = ms5611_cont.deref34;
                uint16_t n_cont14 = ms5611_cont.deref36;
                int32_t n_cont15 = *n_cse72;
                int64_t n_cse108 = (int64_t) ((int64_t) n_cont14 * (int64_t) n_cont15);
                int64_t n_cse112 = (int64_t) (n_cse108 / (int64_t) 128);
                
                ms5611_cont.let43 = (int64_t) ((int64_t) ((int64_t) 65536 * (int64_t) n_cont13) + (int64_t) ((bool) ((int64_t) (n_cse108 % (int64_t) 128) < (int64_t) 0) ? (int64_t) (n_cse112 - (int64_t) 1) : n_cse112));
                
                uint16_t n_cont16 = ms5611_cont.deref33;
                uint16_t n_cont17 = ms5611_cont.deref35;
                int32_t n_cont18 = *n_cse72;
                int64_t n_cse126 = (int64_t) ((int64_t) n_cont17 * (int64_t) n_cont18);
                int64_t n_cse130 = (int64_t) (n_cse126 / (int64_t) 256);
                
                ms5611_cont.let44 = (int64_t) ((int64_t) ((int64_t) n_cont16 * (int64_t) 32768) + (int64_t) ((bool) ((int64_t) (n_cse126 % (int64_t) 256) < (int64_t) 0) ? (int64_t) (n_cse130 - (int64_t) 1) : n_cse130));
                
                uint32_t n_cont19 = ms5611_cont.deref39;
                int64_t n_cont20 = ms5611_cont.let44;
                int64_t n_cont21 = ms5611_cont.let43;
                int64_t n_cse141 = (int64_t) ((int64_t) n_cont19 * n_cont20);
                int64_t n_cse147 = (int64_t) (n_cse141 / (int64_t) 2097152);
                int64_t n_cse152 = (int64_t) ((int64_t) ((bool) ((int64_t) (n_cse141 % (int64_t) 2097152) < (int64_t) 0) ? (int64_t) (n_cse147 - (int64_t) 1) : n_cse147) - n_cont21);
                int64_t n_cse156 = (int64_t) (n_cse152 / (int64_t) 32768);
                int64_t n_cse160 = (int64_t) ((bool) ((int64_t) (n_cse152 % (int64_t) 32768) < (int64_t) 0) ? (int64_t) (n_cse156 - (int64_t) 1) : n_cse156);
                
                ms5611_cont.let45 = (int32_t) ((bool) ((bool) (n_cse160 <= n_cse93) && (bool) (n_cse160 >= n_cse95)) ? (int32_t) n_cse160 : (int32_t) 0);
                ms5611_cont.deref46 = sample.sample_time;
                
                int32_t n_cont22 = ms5611_cont.let45;
                
                measurement.pressure = (float) ((float) n_cont22 / 100.0f);
                
                int32_t n_cont23 = ms5611_cont.let42;
                
                measurement.temperature = (float) ((float) n_cont23 / 100.0f);
                
                int64_t n_cont24 = ms5611_cont.deref46;
                
                measurement.time = n_cont24;
                emitter_ms5611_chan_177(&measurement);
                ms5611_cont.state = (uint32_t) 8U;
            }
            if ((bool) (n_state == (uint32_t) 3U)) {
                ms5611_cont.r24 = last_value_4;
                ms5611_cont.deref25 = ms5611_cont.r24.resultcode;
                
                uint8_t n_cont26 = ms5611_cont.deref25;
                
                if ((bool) (n_cont26 > 0)) {
                    measurement.samplefail = true;
                }
                ms5611_cont.state = (uint32_t) 2U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 5U)) {
                ms5611_cont.r16 = last_value_4;
                
                const struct spi_transaction_result *n_cse191 = &ms5611_cont.r16;
                
                ms5611_cont.deref17 = n_cse191->resultcode;
                
                uint8_t n_cont27 = ms5611_cont.deref17;
                
                if ((bool) (n_cont27 > 0)) {
                    measurement.samplefail = true;
                }
                
                const uint8_t *n_cse197 = n_cse191->rx_buf;
                
                ms5611_cont.deref18 = n_cse197[(int32_t) 1];
                ms5611_cont.deref19 = n_cse197[(int32_t) 2];
                ms5611_cont.deref20 = n_cse197[(int32_t) 3];
                
                uint8_t n_cont0 = ms5611_cont.deref18;
                uint8_t n_cont1 = ms5611_cont.deref19;
                uint8_t n_cont2 = ms5611_cont.deref20;
                
                ms5611_cont.let21 = (uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) n_cont0 << (uint32_t) 16U) + (uint32_t) ((uint32_t) n_cont1 << (uint32_t) 8U)) + (uint32_t) n_cont2);
                
                uint32_t n_cont3 = ms5611_cont.let21;
                
                sample.sample_pressure = n_cont3;
                
                struct spi_transaction_request n_local22 = {.tx_device =(uint8_t) 2U, .tx_buf ={(uint8_t) 88U}, .tx_len =(int32_t) 1};
                struct spi_transaction_request *n_local22_ref = &n_local22;
                
                ms5611_cont.local22 = *n_local22_ref;
                emitter_ms5611_chan_175(&ms5611_cont.local22);
                ms5611_cont.state = (uint32_t) 3U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 7U)) {
                ms5611_cont.r14 = last_value_4;
                ms5611_cont.deref15 = ms5611_cont.r14.resultcode;
                
                uint8_t n_cont28 = ms5611_cont.deref15;
                
                if ((bool) (n_cont28 > 0)) {
                    measurement.samplefail = true;
                }
                continuationMode = (uint32_t) 6U;
                ms5611_cont.state = (uint32_t) 5U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 8U)) {
                measurement.samplefail = false;
                
                struct spi_transaction_request n_local12 = {.tx_device =(uint8_t) 2U, .tx_buf ={(uint8_t) 72U}, .tx_len =(int32_t) 1};
                struct spi_transaction_request *n_local12_ref = &n_local12;
                
                ms5611_cont.local12 = *n_local12_ref;
                emitter_ms5611_chan_175(&ms5611_cont.local12);
                ms5611_cont.state = (uint32_t) 7U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 10U)) {
                ms5611_cont.r7 = last_value_4;
                
                const struct spi_transaction_result *n_cse243 = &ms5611_cont.r7;
                
                ms5611_cont.deref8 = n_cse243->resultcode;
                
                uint8_t n_cont36 = ms5611_cont.deref8;
                
                if ((bool) (n_cont36 > 0)) {
                    measurement.initfail = true;
                }
                
                const uint8_t *n_cse249 = n_cse243->rx_buf;
                
                ms5611_cont.deref9 = n_cse249[(int32_t) 1];
                ms5611_cont.deref10 = n_cse249[(int32_t) 2];
                
                uint8_t n_cont31 = ms5611_cont.deref9;
                uint8_t n_cont32 = ms5611_cont.deref10;
                
                ms5611_cont.let11 = (uint16_t) ((uint16_t) ((uint16_t) n_cont31 << (uint16_t) 8U) + (uint16_t) n_cont32);
                
                const int32_t *n_cse262 = &ms5611_cont.ix4;
                int32_t n_cont33 = *n_cse262;
                uint16_t n_cont34 = ms5611_cont.let11;
                
                calibration.coeff[n_cont33] = n_cont34;
                
                int32_t n_cont35 = *n_cse262;
                
                ms5611_cont.ix4 = (int32_t) ((int32_t) 1 + n_cont35);
                ms5611_cont.state = (uint32_t) 11U;
            }
            if ((bool) (n_state == (uint32_t) 11U)) {
                const int32_t *n_cse270 = &ms5611_cont.ix4;
                int32_t n_cont29 = *n_cse270;
                
                if ((bool) (n_cont29 > (int32_t) 5)) {
                    ms5611_cont.state = (uint32_t) 8U;
                } else {
                    int32_t n_cont30 = *n_cse270;
                    int32_t n_cse274 = (int32_t) ((int32_t) 1 + n_cont30);
                    struct spi_transaction_request n_local5 = {.tx_device =(uint8_t) 2U, .tx_buf ={(uint8_t) ((uint8_t) ((uint8_t) 2U * (uint8_t) ((bool) ((bool) (n_cse274 <= (int32_t) UINT8_MAX) && (bool) (n_cse274 >= (int32_t) 0)) ? (uint8_t) n_cse274 : 0)) | (uint8_t) 160U), (uint8_t) 0U, (uint8_t) 0U}, .tx_len =(int32_t) 3};
                    struct spi_transaction_request *n_local5_ref = &n_local5;
                    
                    ms5611_cont.local5 = *n_local5_ref;
                    emitter_ms5611_chan_175(&ms5611_cont.local5);
                    ms5611_cont.state = (uint32_t) 10U;
                    break;
                }
            }
            if ((bool) (n_state == (uint32_t) 13U)) {
                ms5611_cont.r2 = last_value_4;
                ms5611_cont.deref3 = ms5611_cont.r2.resultcode;
                
                uint8_t n_cont37 = ms5611_cont.deref3;
                
                if ((bool) (n_cont37 > 0)) {
                    measurement.samplefail = true;
                }
                continuationMode = (uint32_t) 5U;
                ms5611_cont.ix4 = (int32_t) 0;
                ms5611_cont.state = (uint32_t) 11U;
            }
            if ((bool) (n_state == (uint32_t) 15U)) {
                ms5611_cont.r0 = last_value_4;
                ms5611_cont.deref1 = ms5611_cont.r0.resultcode;
                
                uint8_t n_cont38 = ms5611_cont.deref1;
                
                if ((bool) (n_cont38 > 0)) {
                    measurement.samplefail = true;
                }
                continuationMode = (uint32_t) 3U;
                ms5611_cont.state = (uint32_t) 13U;
                break;
            }
            if ((bool) ((uint32_t) 16U == n_state)) {
                continuationMode = (uint32_t) 1U;
                ms5611_cont.state = (uint32_t) 15U;
                break;
            }
        }
    }
}

void callback_lsm303d_coroutine_init_thread_init(const int64_t *n_var0)
{
    bool n_local0 = true;
    bool *n_ref1 = &n_local0;
    
    emitter_lsm303d_coroutine_init_chan_174(n_ref1);
}

void callback_lsm303d_coroutine_thread_init(const bool *n_var0)
{
    bool n_deref0 = *n_var0;
    
    if (n_deref0) {
        lsm303d_coroutine_cont.state = (uint32_t) 33U;
    }
    {
        int forever_loop __attribute__((unused));
        
        for (forever_loop = 0; IFOREVER; IFOREVER_INC) {
            uint32_t n_state = lsm303d_coroutine_cont.state;
            
            if ((bool) ((uint32_t) 2U == n_state)) {
                lsm303d_coroutine_cont.r80 = last_value_3;
                /* update samplefail field */
                ;
                
                const struct spi_transaction_result *n_cse5 = &lsm303d_coroutine_cont.r80;
                
                lsm303d_coroutine_cont.deref81 = n_cse5->resultcode;
                
                uint8_t n_cont38 = lsm303d_coroutine_cont.deref81;
                
                if ((bool) (n_cont38 > 0)) {
                    mag_s.samplefail = true;
                    accel_s.samplefail = true;
                }
                /* put results in acc_sample field */
                ;
                
                const uint8_t *n_cse12 = n_cse5->rx_buf;
                
                lsm303d_coroutine_cont.deref82 = n_cse12[(int32_t) 1];
                lsm303d_coroutine_cont.deref83 = n_cse12[(int32_t) 2];
                
                uint8_t n_cont21 = lsm303d_coroutine_cont.deref82;
                uint8_t n_cont22 = lsm303d_coroutine_cont.deref83;
                
                lsm303d_coroutine_cont.let84 = (uint16_t) ((uint16_t) n_cont21 + (uint16_t) ((uint16_t) n_cont22 << (uint16_t) 8U));
                
                uint16_t n_cont23 = lsm303d_coroutine_cont.let84;
                
                lsm303d_coroutine_cont.let85 = (int16_t) ((bool) ((uint16_t) 1U == (uint16_t) (n_cont23 >> (uint16_t) 15U)) ? (int16_t) ((int16_t) -((int16_t) (uint16_t) ~n_cont23) - (int16_t) 1) : (int16_t) n_cont23);
                
                int16_t n_cont24 = lsm303d_coroutine_cont.let85;
                
                lsm303d_coroutine_cont.let86 = (float) ((float) n_cont24 * 2.3928226e-3f);
                
                float n_cont25 = lsm303d_coroutine_cont.let86;
                struct xyz *n_cse41 = &accel_s.sample;
                
                n_cse41->x = n_cont25;
                lsm303d_coroutine_cont.deref87 = n_cse12[(int32_t) 3];
                lsm303d_coroutine_cont.deref88 = n_cse12[(int32_t) 4];
                
                uint8_t n_cont26 = lsm303d_coroutine_cont.deref87;
                uint8_t n_cont27 = lsm303d_coroutine_cont.deref88;
                
                lsm303d_coroutine_cont.let89 = (uint16_t) ((uint16_t) n_cont26 + (uint16_t) ((uint16_t) n_cont27 << (uint16_t) 8U));
                
                uint16_t n_cont28 = lsm303d_coroutine_cont.let89;
                
                lsm303d_coroutine_cont.let90 = (int16_t) ((bool) ((uint16_t) 1U == (uint16_t) (n_cont28 >> (uint16_t) 15U)) ? (int16_t) ((int16_t) -((int16_t) (uint16_t) ~n_cont28) - (int16_t) 1) : (int16_t) n_cont28);
                
                int16_t n_cont29 = lsm303d_coroutine_cont.let90;
                
                lsm303d_coroutine_cont.let91 = (float) (2.3928226e-3f * (float) n_cont29);
                
                float n_cont30 = lsm303d_coroutine_cont.let91;
                
                n_cse41->y = n_cont30;
                lsm303d_coroutine_cont.deref92 = n_cse12[(int32_t) 5];
                lsm303d_coroutine_cont.deref93 = n_cse12[(int32_t) 6];
                
                uint8_t n_cont31 = lsm303d_coroutine_cont.deref92;
                uint8_t n_cont32 = lsm303d_coroutine_cont.deref93;
                
                lsm303d_coroutine_cont.let94 = (uint16_t) ((uint16_t) n_cont31 + (uint16_t) ((uint16_t) n_cont32 << (uint16_t) 8U));
                
                uint16_t n_cont33 = lsm303d_coroutine_cont.let94;
                
                lsm303d_coroutine_cont.let95 = (int16_t) ((bool) ((uint16_t) 1U == (uint16_t) (n_cont33 >> (uint16_t) 15U)) ? (int16_t) ((int16_t) -((int16_t) (uint16_t) ~n_cont33) - (int16_t) 1) : (int16_t) n_cont33);
                
                int16_t n_cont34 = lsm303d_coroutine_cont.let95;
                
                lsm303d_coroutine_cont.let96 = (float) (2.3928226e-3f * (float) n_cont34);
                
                float n_cont35 = lsm303d_coroutine_cont.let96;
                
                n_cse41->z = n_cont35;
                /* record time and emit sample */
                ;
                
                int64_t n_r97 = tower_get_time();
                
                lsm303d_coroutine_cont.r97 = n_r97;
                
                const int64_t *n_cse104 = &lsm303d_coroutine_cont.r97;
                int64_t n_cont36 = *n_cse104;
                
                mag_s.time = n_cont36;
                
                int64_t n_cont37 = *n_cse104;
                
                accel_s.time = n_cont37;
                emitter_lsm303d_coroutine_chan_172(&mag_s);
                lsm303d_coroutine_cont.state = (uint32_t) 3U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 3U)) {
                lsm303d_coroutine_cont.r61 = last_value_3;
                /* reset samplefail field */
                ;
                
                const struct spi_transaction_result *n_cse111 = &lsm303d_coroutine_cont.r61;
                
                lsm303d_coroutine_cont.deref62 = n_cse111->resultcode;
                
                const uint8_t *n_cse113 = &lsm303d_coroutine_cont.deref62;
                uint8_t n_cont4 = *n_cse113;
                
                mag_s.samplefail = (bool) (n_cont4 > 0);
                
                uint8_t n_cont5 = *n_cse113;
                
                accel_s.samplefail = (bool) (n_cont5 > 0);
                /* put results in mag_sample field */
                ;
                
                const uint8_t *n_cse119 = n_cse111->rx_buf;
                
                lsm303d_coroutine_cont.deref63 = n_cse119[(int32_t) 1];
                lsm303d_coroutine_cont.deref64 = n_cse119[(int32_t) 2];
                
                uint8_t n_cont6 = lsm303d_coroutine_cont.deref63;
                uint8_t n_cont7 = lsm303d_coroutine_cont.deref64;
                
                lsm303d_coroutine_cont.let65 = (uint16_t) ((uint16_t) n_cont6 + (uint16_t) ((uint16_t) n_cont7 << (uint16_t) 8U));
                
                uint16_t n_cont8 = lsm303d_coroutine_cont.let65;
                
                lsm303d_coroutine_cont.let66 = (int16_t) ((bool) ((uint16_t) 1U == (uint16_t) (n_cont8 >> (uint16_t) 15U)) ? (int16_t) ((int16_t) -((int16_t) (uint16_t) ~n_cont8) - (int16_t) 1) : (int16_t) n_cont8);
                
                int16_t n_cont9 = lsm303d_coroutine_cont.let66;
                
                lsm303d_coroutine_cont.let67 = (float) ((float) n_cont9 * 8.0000005e-5f);
                
                float n_cont10 = lsm303d_coroutine_cont.let67;
                struct xyz *n_cse148 = &mag_s.sample;
                
                n_cse148->x = n_cont10;
                lsm303d_coroutine_cont.deref68 = n_cse119[(int32_t) 3];
                lsm303d_coroutine_cont.deref69 = n_cse119[(int32_t) 4];
                
                uint8_t n_cont11 = lsm303d_coroutine_cont.deref68;
                uint8_t n_cont12 = lsm303d_coroutine_cont.deref69;
                
                lsm303d_coroutine_cont.let70 = (uint16_t) ((uint16_t) n_cont11 + (uint16_t) ((uint16_t) n_cont12 << (uint16_t) 8U));
                
                uint16_t n_cont13 = lsm303d_coroutine_cont.let70;
                
                lsm303d_coroutine_cont.let71 = (int16_t) ((bool) ((uint16_t) 1U == (uint16_t) (n_cont13 >> (uint16_t) 15U)) ? (int16_t) ((int16_t) -((int16_t) (uint16_t) ~n_cont13) - (int16_t) 1) : (int16_t) n_cont13);
                
                int16_t n_cont14 = lsm303d_coroutine_cont.let71;
                
                lsm303d_coroutine_cont.let72 = (float) (8.0000005e-5f * (float) n_cont14);
                
                float n_cont15 = lsm303d_coroutine_cont.let72;
                
                n_cse148->y = n_cont15;
                lsm303d_coroutine_cont.deref73 = n_cse119[(int32_t) 5];
                lsm303d_coroutine_cont.deref74 = n_cse119[(int32_t) 6];
                
                uint8_t n_cont16 = lsm303d_coroutine_cont.deref73;
                uint8_t n_cont17 = lsm303d_coroutine_cont.deref74;
                
                lsm303d_coroutine_cont.let75 = (uint16_t) ((uint16_t) n_cont16 + (uint16_t) ((uint16_t) n_cont17 << (uint16_t) 8U));
                
                uint16_t n_cont18 = lsm303d_coroutine_cont.let75;
                
                lsm303d_coroutine_cont.let76 = (int16_t) ((bool) ((uint16_t) 1U == (uint16_t) (n_cont18 >> (uint16_t) 15U)) ? (int16_t) ((int16_t) -((int16_t) (uint16_t) ~n_cont18) - (int16_t) 1) : (int16_t) n_cont18);
                
                int16_t n_cont19 = lsm303d_coroutine_cont.let76;
                
                lsm303d_coroutine_cont.let77 = (float) (8.0000005e-5f * (float) n_cont19);
                
                float n_cont20 = lsm303d_coroutine_cont.let77;
                
                n_cse148->z = n_cont20;
                /* send accel read request */
                ;
                
                struct spi_transaction_request n_local78 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 232U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U,
                                                                                                (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U,
                                                                                                (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U,
                                                                                                (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U,
                                                                                                (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U,
                                                                                                (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U, (uint8_t) 0U,
                                                                                                (uint8_t) 0U, (uint8_t) 0U}, .tx_len =(int32_t) 7};
                struct spi_transaction_request *n_local78_ref = &n_local78;
                
                lsm303d_coroutine_cont.local78 = *n_local78_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local78);
                /* receive accel read result */
                ;
                lsm303d_coroutine_cont.state = (uint32_t) 2U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 5U)) {
                lsm303d_coroutine_cont.r59 = last_value_3;
                lsm303d_coroutine_cont.deref60 = lsm303d_coroutine_cont.r59.resultcode;
                
                uint8_t n_cont39 = lsm303d_coroutine_cont.deref60;
                
                if ((bool) (n_cont39 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                initialized = true;
                /* finished initialization in lsm303d coroutine */
                ;
                /* Recieve mag read result. */
                ;
                /* Request originates from periodic handler below. */
                ;
                lsm303d_coroutine_cont.state = (uint32_t) 3U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 7U)) {
                lsm303d_coroutine_cont.r55 = last_value_3;
                lsm303d_coroutine_cont.deref56 = lsm303d_coroutine_cont.r55.resultcode;
                
                uint8_t n_cont40 = lsm303d_coroutine_cont.deref56;
                
                if ((bool) (n_cont40 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegWrite R_Control7 0x26 0x0 */
                ;
                
                struct spi_transaction_request n_local57 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 38U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local57_ref = &n_local57;
                
                lsm303d_coroutine_cont.local57 = *n_local57_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local57);
                lsm303d_coroutine_cont.state = (uint32_t) 5U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 9U)) {
                lsm303d_coroutine_cont.r51 = last_value_3;
                lsm303d_coroutine_cont.deref52 = lsm303d_coroutine_cont.r51.resultcode;
                
                uint8_t n_cont41 = lsm303d_coroutine_cont.deref52;
                
                if ((bool) (n_cont41 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegWrite R_Control6 0x25 0x0 */
                ;
                
                struct spi_transaction_request n_local53 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 37U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local53_ref = &n_local53;
                
                lsm303d_coroutine_cont.local53 = *n_local53_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local53);
                lsm303d_coroutine_cont.state = (uint32_t) 7U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 11U)) {
                lsm303d_coroutine_cont.r47 = last_value_3;
                lsm303d_coroutine_cont.deref48 = lsm303d_coroutine_cont.r47.resultcode;
                
                uint8_t n_cont42 = lsm303d_coroutine_cont.deref48;
                
                if ((bool) (n_cont42 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegWrite R_Control5 0x24 0x14 */
                ;
                
                struct spi_transaction_request n_local49 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 36U, (uint8_t) 20U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local49_ref = &n_local49;
                
                lsm303d_coroutine_cont.local49 = *n_local49_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local49);
                lsm303d_coroutine_cont.state = (uint32_t) 9U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 13U)) {
                lsm303d_coroutine_cont.r43 = last_value_3;
                lsm303d_coroutine_cont.deref44 = lsm303d_coroutine_cont.r43.resultcode;
                
                uint8_t n_cont43 = lsm303d_coroutine_cont.deref44;
                
                if ((bool) (n_cont43 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegWrite R_Control2 0x21 0xd8 */
                ;
                
                struct spi_transaction_request n_local45 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 33U, (uint8_t) 216U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local45_ref = &n_local45;
                
                lsm303d_coroutine_cont.local45 = *n_local45_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local45);
                lsm303d_coroutine_cont.state = (uint32_t) 11U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 15U)) {
                lsm303d_coroutine_cont.r39 = last_value_3;
                lsm303d_coroutine_cont.deref40 = lsm303d_coroutine_cont.r39.resultcode;
                
                uint8_t n_cont44 = lsm303d_coroutine_cont.deref40;
                
                if ((bool) (n_cont44 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegWrite R_Control1 0x20 0x9f */
                ;
                
                struct spi_transaction_request n_local41 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 32U, (uint8_t) 159U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local41_ref = &n_local41;
                
                lsm303d_coroutine_cont.local41 = *n_local41_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local41);
                lsm303d_coroutine_cont.state = (uint32_t) 13U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 17U)) {
                lsm303d_coroutine_cont.r34 = last_value_3;
                
                const struct spi_transaction_result *n_cse292 = &lsm303d_coroutine_cont.r34;
                
                lsm303d_coroutine_cont.deref35 = n_cse292->resultcode;
                
                uint8_t n_cont45 = lsm303d_coroutine_cont.deref35;
                
                if ((bool) (n_cont45 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                lsm303d_coroutine_cont.deref36 = n_cse292->rx_buf[(int32_t) 1];
                
                uint8_t n_cont3 = lsm303d_coroutine_cont.deref36;
                struct spi_transaction_request n_local37 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 2U, (uint8_t) (n_cont3 & (uint8_t) 231U)}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local37_ref = &n_local37;
                
                lsm303d_coroutine_cont.local37 = *n_local37_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local37);
                lsm303d_coroutine_cont.state = (uint32_t) 15U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 19U)) {
                lsm303d_coroutine_cont.r30 = last_value_3;
                lsm303d_coroutine_cont.deref31 = lsm303d_coroutine_cont.r30.resultcode;
                
                uint8_t n_cont46 = lsm303d_coroutine_cont.deref31;
                
                if ((bool) (n_cont46 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegModify R_Magic1 */
                ;
                
                struct spi_transaction_request n_local32 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 130U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local32_ref = &n_local32;
                
                lsm303d_coroutine_cont.local32 = *n_local32_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local32);
                lsm303d_coroutine_cont.state = (uint32_t) 17U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 21U)) {
                lsm303d_coroutine_cont.r25 = last_value_3;
                
                const struct spi_transaction_result *n_cse324 = &lsm303d_coroutine_cont.r25;
                
                lsm303d_coroutine_cont.deref26 = n_cse324->resultcode;
                
                uint8_t n_cont47 = lsm303d_coroutine_cont.deref26;
                
                if ((bool) (n_cont47 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                lsm303d_coroutine_cont.deref27 = n_cse324->rx_buf[(int32_t) 1];
                
                uint8_t n_cont2 = lsm303d_coroutine_cont.deref27;
                struct spi_transaction_request n_local28 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 21U, (uint8_t) (n_cont2 | (uint8_t) 128U)}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local28_ref = &n_local28;
                
                lsm303d_coroutine_cont.local28 = *n_local28_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local28);
                lsm303d_coroutine_cont.state = (uint32_t) 19U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 23U)) {
                lsm303d_coroutine_cont.r21 = last_value_3;
                lsm303d_coroutine_cont.deref22 = lsm303d_coroutine_cont.r21.resultcode;
                
                uint8_t n_cont48 = lsm303d_coroutine_cont.deref22;
                
                if ((bool) (n_cont48 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegModify R_Magic2 */
                ;
                
                struct spi_transaction_request n_local23 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 149U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local23_ref = &n_local23;
                
                lsm303d_coroutine_cont.local23 = *n_local23_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local23);
                lsm303d_coroutine_cont.state = (uint32_t) 21U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 25U)) {
                lsm303d_coroutine_cont.r16 = last_value_3;
                
                const struct spi_transaction_result *n_cse356 = &lsm303d_coroutine_cont.r16;
                
                lsm303d_coroutine_cont.deref17 = n_cse356->resultcode;
                
                uint8_t n_cont49 = lsm303d_coroutine_cont.deref17;
                
                if ((bool) (n_cont49 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                lsm303d_coroutine_cont.deref18 = n_cse356->rx_buf[(int32_t) 1];
                
                uint8_t n_cont1 = lsm303d_coroutine_cont.deref18;
                struct spi_transaction_request n_local19 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 2U, (uint8_t) (n_cont1 & (uint8_t) 247U)}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local19_ref = &n_local19;
                
                lsm303d_coroutine_cont.local19 = *n_local19_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local19);
                lsm303d_coroutine_cont.state = (uint32_t) 23U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 27U)) {
                lsm303d_coroutine_cont.r12 = last_value_3;
                lsm303d_coroutine_cont.deref13 = lsm303d_coroutine_cont.r12.resultcode;
                
                uint8_t n_cont50 = lsm303d_coroutine_cont.deref13;
                
                if ((bool) (n_cont50 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegModify R_Magic1 */
                ;
                
                struct spi_transaction_request n_local14 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 130U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local14_ref = &n_local14;
                
                lsm303d_coroutine_cont.local14 = *n_local14_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local14);
                lsm303d_coroutine_cont.state = (uint32_t) 25U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 29U)) {
                lsm303d_coroutine_cont.r7 = last_value_3;
                
                const struct spi_transaction_result *n_cse388 = &lsm303d_coroutine_cont.r7;
                
                lsm303d_coroutine_cont.deref8 = n_cse388->resultcode;
                
                uint8_t n_cont51 = lsm303d_coroutine_cont.deref8;
                
                if ((bool) (n_cont51 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                lsm303d_coroutine_cont.deref9 = n_cse388->rx_buf[(int32_t) 1];
                
                uint8_t n_cont0 = lsm303d_coroutine_cont.deref9;
                struct spi_transaction_request n_local10 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 2U, (uint8_t) (n_cont0 | (uint8_t) 16U)}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local10_ref = &n_local10;
                
                lsm303d_coroutine_cont.local10 = *n_local10_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local10);
                lsm303d_coroutine_cont.state = (uint32_t) 27U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 32U)) {
                lsm303d_coroutine_cont.r2 = last_value_3;
                
                const struct spi_transaction_result *n_cse407 = &lsm303d_coroutine_cont.r2;
                
                lsm303d_coroutine_cont.deref3 = n_cse407->resultcode;
                
                uint8_t n_cont53 = lsm303d_coroutine_cont.deref3;
                
                if ((bool) (n_cont53 > 0)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                lsm303d_coroutine_cont.deref4 = n_cse407->rx_buf[(int32_t) 1];
                
                uint8_t n_cont52 = lsm303d_coroutine_cont.deref4;
                
                if ((bool) (n_cont52 != (uint8_t) 73U)) {
                    mag_s.initfail = true;
                    accel_s.initfail = true;
                }
                /* RegModify R_Magic1 */
                ;
                
                struct spi_transaction_request n_local5 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 130U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local5_ref = &n_local5;
                
                lsm303d_coroutine_cont.local5 = *n_local5_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local5);
                lsm303d_coroutine_cont.state = (uint32_t) 29U;
                break;
            }
            if ((bool) ((uint32_t) 33U == n_state)) {
                /* begin initialization in lsm303d coroutine */
                ;
                /* RegRead R_WhoAmI */
                ;
                
                struct spi_transaction_request n_local0 = {.tx_device =(uint8_t) 1U, .tx_buf ={(uint8_t) 143U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local0_ref = &n_local0;
                
                lsm303d_coroutine_cont.local0 = *n_local0_ref;
                emitter_lsm303d_coroutine_chan_170(&lsm303d_coroutine_cont.local0);
                lsm303d_coroutine_cont.state = (uint32_t) 32U;
                break;
            }
        }
    }
}

void callback_mpu6000_init_thread_init(const int64_t *n_var0)
{
    bool n_local0 = true;
    bool *n_ref1 = &n_local0;
    
    emitter_mpu6000_init_chan_169(n_ref1);
}

void callback_mpu6000_thread_init(const bool *n_var0)
{
    bool n_deref0 = *n_var0;
    
    if (n_deref0) {
        mpu6000_cont.state = (uint32_t) 12U;
    }
    {
        int forever_loop __attribute__((unused));
        
        for (forever_loop = 0; IFOREVER; IFOREVER_INC) {
            uint32_t n_state = mpu6000_cont.state;
            
            if ((bool) (0 == n_state)) {
                mpu6000_cont.state = (uint32_t) 0U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 1U)) {
                mpu6000_cont.r23 = last_value_2;
                /* Got a response, sending it up the stack */
                ;
                transaction_pending = false;
                
                int64_t n_r24 = tower_get_time();
                
                mpu6000_cont.r24 = n_r24;
                
                const struct spi_transaction_result *n_cse8 = &mpu6000_cont.r23;
                
                mpu6000_cont.deref25 = n_cse8->resultcode;
                
                struct mpu6000_response n_local26;
                struct mpu6000_response *n_local26_ref = &n_local26;
                struct mpu6000_response *n_cse10 = &mpu6000_cont.local26;
                
                *n_cse10 = *n_local26_ref;
                mpu6000_response_get_be((const uint8_t *) n_cse8->rx_buf, (uint32_t) 1U, n_cse10);
                /* store sample failure */
                ;
                
                const uint8_t *n_cse13 = &mpu6000_cont.deref25;
                uint8_t n_cont0 = *n_cse13;
                
                gyro.samplefail = (bool) (n_cont0 > 0);
                
                uint8_t n_cont1 = *n_cse13;
                
                accel.samplefail = (bool) (n_cont1 > 0);
                /* apply calibration, which converts to rads/sec */
                ;
                /* we rotate the X/Y plane 90 degrees to match Pixhawk's silk-screened orientation */
                ;
                
                const struct mpu6000_response *n_cse19 = &mpu6000_cont.local26;
                
                mpu6000_cont.deref28 = n_cse19->gy;
                
                int16_t n_cont2 = mpu6000_cont.deref28;
                struct xyz *n_cse22 = &gyro.sample;
                
                n_cse22->x = (float) ((float) n_cont2 * 1.0642195e-3f);
                mpu6000_cont.deref29 = n_cse19->gx;
                
                int16_t n_cont3 = mpu6000_cont.deref29;
                
                n_cse22->y = (float) (1.0642195e-3f * (float) (int16_t) -n_cont3);
                mpu6000_cont.deref30 = n_cse19->gz;
                
                int16_t n_cont4 = mpu6000_cont.deref30;
                
                n_cse22->z = (float) (1.0642195e-3f * (float) n_cont4);
                /* apply calibation, which subtracts offsets and converts to m/s/s by way of g */
                ;
                /* we rotate the X/Y plane 90 degrees to match Pixhawk's silk-screened orientation */
                ;
                mpu6000_cont.deref31 = n_cse19->ay;
                
                int16_t n_cont5 = mpu6000_cont.deref31;
                struct xyz *n_cse45 = &accel.sample;
                
                n_cse45->x = (float) ((float) n_cont5 * 2.3942017e-3f);
                mpu6000_cont.deref32 = n_cse19->ax;
                
                int16_t n_cont6 = mpu6000_cont.deref32;
                
                n_cse45->y = (float) (2.3942017e-3f * (float) (int16_t) -n_cont6);
                mpu6000_cont.deref33 = n_cse19->az;
                
                int16_t n_cont7 = mpu6000_cont.deref33;
                
                n_cse45->z = (float) (2.3942017e-3f * (float) n_cont7);
                /* convert to degrees Celsius */
                ;
                mpu6000_cont.deref34 = n_cse19->temp;
                
                uint16_t n_cont8 = mpu6000_cont.deref34;
                
                mpu6000_cont.let35 = (float) ((float) ((float) n_cont8 / 340.0f) + 36.53f);
                
                const float *n_cse72 = &mpu6000_cont.let35;
                float n_cont9 = *n_cse72;
                
                gyro.temperature = n_cont9;
                
                float n_cont10 = *n_cse72;
                
                accel.temperature = n_cont10;
                /* store sample time */
                ;
                
                const int64_t *n_cse75 = &mpu6000_cont.r24;
                int64_t n_cont11 = *n_cse75;
                
                gyro.time = n_cont11;
                
                int64_t n_cont12 = *n_cse75;
                
                accel.time = n_cont12;
                emitter_mpu6000_chan_157(&gyro);
                emitter_mpu6000_chan_156(&accel);
                mpu6000_cont.state = (uint32_t) 1U;
                break;
            }
            if ((bool) ((uint32_t) 2U == n_state)) {
                mpu6000_cont.r22 = last_value_2;
                ready = true;
                /* Wait for responses to periodic requests */
                ;
                mpu6000_cont.state = (uint32_t) 1U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 3U)) {
                mpu6000_cont.r19 = last_value_2;
                /* Set gyro scale to +/- 2000 dps */
                ;
                
                struct spi_transaction_request n_local20 = {.tx_device =(uint8_t) 0U, .tx_buf ={(uint8_t) 27U, (uint8_t) 24U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local20_ref = &n_local20;
                
                mpu6000_cont.local20 = *n_local20_ref;
                emitter_mpu6000_chan_167(&mpu6000_cont.local20);
                mpu6000_cont.state = (uint32_t) 2U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 4U)) {
                mpu6000_cont.r16 = last_value_2;
                /* Set accelerometer scale to +/- 8 */
                ;
                
                struct spi_transaction_request n_local17 = {.tx_device =(uint8_t) 0U, .tx_buf ={(uint8_t) 28U, (uint8_t) 16U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local17_ref = &n_local17;
                
                mpu6000_cont.local17 = *n_local17_ref;
                emitter_mpu6000_chan_167(&mpu6000_cont.local17);
                mpu6000_cont.state = (uint32_t) 3U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 5U)) {
                mpu6000_cont.r13 = last_value_2;
                /* sample rate: 200.0Hz */
                ;
                
                struct spi_transaction_request n_local14 = {.tx_device =(uint8_t) 0U, .tx_buf ={(uint8_t) 25U, (uint8_t) 5U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local14_ref = &n_local14;
                
                mpu6000_cont.local14 = *n_local14_ref;
                emitter_mpu6000_chan_167(&mpu6000_cont.local14);
                mpu6000_cont.state = (uint32_t) 4U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 6U)) {
                mpu6000_cont.r10 = last_value_2;
                /* accel bandwidth: 44Hz, gyro bandwidth: 42Hz, gyro sample rate: 1000Hz */
                ;
                
                struct spi_transaction_request n_local11 = {.tx_device =(uint8_t) 0U, .tx_buf ={(uint8_t) 26U, (uint8_t) 3U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local11_ref = &n_local11;
                
                mpu6000_cont.local11 = *n_local11_ref;
                emitter_mpu6000_chan_167(&mpu6000_cont.local11);
                mpu6000_cont.state = (uint32_t) 5U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 9U)) {
                mpu6000_cont.r5 = last_value_2;
                mpu6000_cont.deref6 = mpu6000_cont.r5.rx_buf[(int32_t) 1];
                /* Device is working when WhoAmI returns 0x68 */
                ;
                
                uint8_t n_cont15 = mpu6000_cont.deref6;
                
                if ((bool) (n_cont15 == (uint8_t) 104U)) {
                    /* Wake the sensor device, use internal oscillator */
                    ;
                    
                    struct spi_transaction_request n_local8 = {.tx_device =(uint8_t) 0U, .tx_buf ={(uint8_t) 107U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                    struct spi_transaction_request *n_local8_ref = &n_local8;
                    
                    mpu6000_cont.local8 = *n_local8_ref;
                    emitter_mpu6000_chan_167(&mpu6000_cont.local8);
                    mpu6000_cont.state = (uint32_t) 6U;
                    break;
                } else {
                    mpu6000_cont.deref7 = retries;
                    
                    const uint8_t *n_cse120 = &mpu6000_cont.deref7;
                    uint8_t n_cont13 = *n_cse120;
                    
                    retries = (uint8_t) ((uint8_t) 1U + n_cont13);
                    
                    uint8_t n_cont14 = *n_cse120;
                    
                    if ((bool) (n_cont14 > (uint8_t) 2U)) {
                        mpu6000_cont.state = (uint32_t) 0U;
                        break;
                    } else {
                        mpu6000_cont.state = (uint32_t) 11U;
                    }
                }
            }
            if ((bool) (n_state == (uint32_t) 10U)) {
                mpu6000_cont.r2 = last_value_2;
                /* Poll the WhoAmI register */
                ;
                
                struct spi_transaction_request n_local3 = {.tx_device =(uint8_t) 0U, .tx_buf ={(uint8_t) 245U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local3_ref = &n_local3;
                
                mpu6000_cont.local3 = *n_local3_ref;
                emitter_mpu6000_chan_167(&mpu6000_cont.local3);
                mpu6000_cont.state = (uint32_t) 9U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 11U)) {
                /* Disable the I2C slave device sharing pins with the SPI interface */
                ;
                
                struct spi_transaction_request n_local0 = {.tx_device =(uint8_t) 0U, .tx_buf ={(uint8_t) 106U, (uint8_t) 16U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local0_ref = &n_local0;
                
                mpu6000_cont.local0 = *n_local0_ref;
                emitter_mpu6000_chan_167(&mpu6000_cont.local0);
                mpu6000_cont.state = (uint32_t) 10U;
                break;
            }
            if ((bool) ((uint32_t) 12U == n_state)) {
                retries = (uint8_t) 0U;
                mpu6000_cont.state = (uint32_t) 11U;
            }
        }
    }
}

void callback_l3gd20_init_thread_init(const int64_t *n_var0)
{
    bool n_local0 = true;
    bool *n_ref1 = &n_local0;
    
    emitter_l3gd20_init_chan_166(n_ref1);
}

void callback_l3gd20_thread_init(const bool *n_var0)
{
    bool n_deref0 = *n_var0;
    
    if (n_deref0) {
        l3gd20_cont.state = (uint32_t) 13U;
    }
    {
        int forever_loop __attribute__((unused));
        
        for (forever_loop = 0; IFOREVER; IFOREVER_INC) {
            uint32_t n_state = l3gd20_cont.state;
            
            if ((bool) (0 == n_state)) {
                l3gd20_cont.state = (uint32_t) 0U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 1U)) {
                l3gd20_cont.r31 = last_value;
                
                int64_t n_r32 = tower_get_time();
                
                l3gd20_cont.r32 = n_r32;
                
                int64_t n_cont0 = l3gd20_cont.r32;
                int64_t n_local33 = n_cont0;
                int64_t *n_local33_ref = &n_local33;
                
                l3gd20_cont.local33 = *n_local33_ref;
                emitter_l3gd20_chan_162(&l3gd20_cont.local33);
                l3gd20_cont.state = (uint32_t) 0U;
                break;
            }
            if ((bool) ((uint32_t) 2U == n_state)) {
                l3gd20_cont.r28 = last_value;
                
                struct spi_transaction_request n_local29 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 36U, (uint8_t) 64U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local29_ref = &n_local29;
                
                l3gd20_cont.local29 = *n_local29_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local29);
                l3gd20_cont.state = (uint32_t) 1U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 3U)) {
                l3gd20_cont.r25 = last_value;
                
                struct spi_transaction_request n_local26 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 36U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local26_ref = &n_local26;
                
                l3gd20_cont.local26 = *n_local26_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local26);
                l3gd20_cont.state = (uint32_t) 2U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 4U)) {
                l3gd20_cont.r22 = last_value;
                
                struct spi_transaction_request n_local23 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 35U, (uint8_t) 128U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local23_ref = &n_local23;
                
                l3gd20_cont.local23 = *n_local23_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local23);
                l3gd20_cont.state = (uint32_t) 3U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 5U)) {
                l3gd20_cont.r19 = last_value;
                
                struct spi_transaction_request n_local20 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 34U, (uint8_t) 8U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local20_ref = &n_local20;
                
                l3gd20_cont.local20 = *n_local20_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local20);
                l3gd20_cont.state = (uint32_t) 4U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 6U)) {
                l3gd20_cont.r16 = last_value;
                
                struct spi_transaction_request n_local17 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 33U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local17_ref = &n_local17;
                
                l3gd20_cont.local17 = *n_local17_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local17);
                l3gd20_cont.state = (uint32_t) 5U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 9U)) {
                l3gd20_cont.r9 = last_value;
                l3gd20_cont.deref10 = l3gd20_cont.r9.rx_buf[(int32_t) 1];
                
                uint8_t n_cont4 = l3gd20_cont.deref10;
                uint8_t n_cont5 = l3gd20_cont.deref3;
                
                if ((bool) (n_cont4 == (uint8_t) (n_cont5 | (uint8_t) 32U))) {
                    struct spi_transaction_request n_local14 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 32U, (uint8_t) 15U}, .tx_len =(int32_t) 2};
                    struct spi_transaction_request *n_local14_ref = &n_local14;
                    
                    l3gd20_cont.local14 = *n_local14_ref;
                    emitter_l3gd20_chan_164(&l3gd20_cont.local14);
                    l3gd20_cont.state = (uint32_t) 6U;
                    break;
                } else {
                    l3gd20_cont.deref11 = l3gd20_retries;
                    
                    const uint8_t *n_cse60 = &l3gd20_cont.deref11;
                    uint8_t n_cont2 = *n_cse60;
                    
                    l3gd20_retries = (uint8_t) ((uint8_t) 1U + n_cont2);
                    
                    uint8_t n_cont3 = *n_cse60;
                    
                    if ((bool) (n_cont3 > (uint8_t) 10U)) {
                        l3gd20_panic = true;
                        
                        bool n_local12 = true;
                        bool *n_local12_ref = &n_local12;
                        
                        l3gd20_cont.local12 = *n_local12_ref;
                        l3gd20_cont.state = (uint32_t) 0U;
                        break;
                    } else {
                        l3gd20_cont.state = (uint32_t) 12U;
                    }
                }
            }
            if ((bool) (n_state == (uint32_t) 10U)) {
                l3gd20_cont.r6 = last_value;
                
                struct spi_transaction_request n_local7 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 133U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local7_ref = &n_local7;
                
                l3gd20_cont.local7 = *n_local7_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local7);
                l3gd20_cont.state = (uint32_t) 9U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 11U)) {
                l3gd20_cont.r2 = last_value;
                l3gd20_cont.deref3 = l3gd20_cont.r2.rx_buf[(int32_t) 1];
                
                uint8_t n_cont1 = l3gd20_cont.deref3;
                struct spi_transaction_request n_local4 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 5U, (uint8_t) (n_cont1 | (uint8_t) 32U)}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local4_ref = &n_local4;
                
                l3gd20_cont.local4 = *n_local4_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local4);
                l3gd20_cont.state = (uint32_t) 10U;
                break;
            }
            if ((bool) (n_state == (uint32_t) 12U)) {
                struct spi_transaction_request n_local0 = {.tx_device =(uint8_t) 3U, .tx_buf ={(uint8_t) 133U, (uint8_t) 0U}, .tx_len =(int32_t) 2};
                struct spi_transaction_request *n_local0_ref = &n_local0;
                
                l3gd20_cont.local0 = *n_local0_ref;
                emitter_l3gd20_chan_164(&l3gd20_cont.local0);
                l3gd20_cont.state = (uint32_t) 11U;
                break;
            }
            if ((bool) ((uint32_t) 13U == n_state)) {
                l3gd20_retries = (uint8_t) 0U;
                l3gd20_cont.state = (uint32_t) 12U;
            }
        }
    }
}

void callback_init_2_thread_init(const int64_t *n_var0)
{
    /* Pixhawk VDD 3V3 Sensors Enable */
    /* Set gpioE3 to assert output */
    ;
    
    uint32_t n_r0 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioe */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r0 | (uint32_t) ((uint32_t) 1U << (uint32_t) 4U)));
    
    uint32_t n_r1 = ivory_hw_io_read_u32((uint32_t) 1073876992U);
    
    /* reg modify gpioE->mode: setField gpio_mode_3 */
    ;
    
    uint32_t n_cse5 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 6U);
    uint32_t n_cse9 = (uint32_t) (uint8_t) ((uint8_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073876992U, (uint32_t) ((uint32_t) (n_r1 & n_cse5) | (uint32_t) (n_cse9 << (uint32_t) 6U)));
    
    uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073876996U);
    
    /* reg modify gpioE->otype: setField gpio_otype_3 */
    ;
    
    uint32_t n_cse13 = (uint32_t) ((uint32_t) 1U << (uint32_t) 3U);
    
    ivory_hw_io_write_u32((uint32_t) 1073876996U, (uint32_t) ((uint32_t) (n_r2 & (uint32_t) ~n_cse13) | (uint32_t) (0 << (uint32_t) 3U)));
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073877000U);
    
    /* reg modify gpioE->ospeed: setField gpio_ospeed_3 */
    ;
    
    uint32_t n_cse23 = (uint32_t) (uint8_t) ((uint8_t) 2U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073877000U, (uint32_t) ((uint32_t) (n_cse5 & n_r3) | (uint32_t) (n_cse23 << (uint32_t) 6U)));
    
    uint32_t n_r4 = ivory_hw_io_read_u32((uint32_t) 1073877016U);
    
    /* reg modify gpioE->bsrr: setBit gpio_bs_3 */
    ivory_hw_io_write_u32((uint32_t) 1073877016U, (uint32_t) (n_cse13 | n_r4));
    /* Pixhawk VDD 5V Periph Enable */
    /* Set gpioA8 to clear output */
    ;
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioa */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) ((uint32_t) ((uint32_t) 1U << 0) | n_r5));
    
    uint32_t n_r6 = ivory_hw_io_read_u32((uint32_t) 1073872896U);
    
    /* reg modify gpioA->mode: setField gpio_mode_8 */
    ;
    
    uint32_t n_cse33 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 16U);
    
    ivory_hw_io_write_u32((uint32_t) 1073872896U, (uint32_t) ((uint32_t) (n_r6 & n_cse33) | (uint32_t) (n_cse9 << (uint32_t) 16U)));
    
    uint32_t n_r7 = ivory_hw_io_read_u32((uint32_t) 1073872900U);
    
    /* reg modify gpioA->otype: setField gpio_otype_8 */
    ivory_hw_io_write_u32((uint32_t) 1073872900U, (uint32_t) ((uint32_t) (n_r7 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 8U)) | (uint32_t) (0 << (uint32_t) 8U)));
    
    uint32_t n_r8 = ivory_hw_io_read_u32((uint32_t) 1073872904U);
    
    /* reg modify gpioA->ospeed: setField gpio_ospeed_8 */
    ivory_hw_io_write_u32((uint32_t) 1073872904U, (uint32_t) ((uint32_t) (n_cse33 & n_r8) | (uint32_t) (n_cse23 << (uint32_t) 16U)));
    
    uint32_t n_r9 = ivory_hw_io_read_u32((uint32_t) 1073872920U);
    
    /* reg modify gpioA->bsrr: setBit gpio_br_8 */
    ivory_hw_io_write_u32((uint32_t) 1073872920U, (uint32_t) (n_r9 | (uint32_t) ((uint32_t) 1U << (uint32_t) 24U)));
    /* assert Gyro CS */
    /* Set gpioC13 to assert output */
    ;
    
    uint32_t n_r10 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioc */
    ;
    
    uint32_t n_cse51 = (uint32_t) ((uint32_t) 1U << (uint32_t) 2U);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r10 | n_cse51));
    
    uint32_t n_r11 = ivory_hw_io_read_u32((uint32_t) 1073874944U);
    
    /* reg modify gpioC->mode: setField gpio_mode_13 */
    ;
    
    uint32_t n_cse55 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 26U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874944U, (uint32_t) ((uint32_t) (n_r11 & n_cse55) | (uint32_t) (n_cse9 << (uint32_t) 26U)));
    
    uint32_t n_r12 = ivory_hw_io_read_u32((uint32_t) 1073874948U);
    
    /* reg modify gpioC->otype: setField gpio_otype_13 */
    ;
    
    uint32_t n_cse60 = (uint32_t) ((uint32_t) 1U << (uint32_t) 13U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874948U, (uint32_t) ((uint32_t) (n_r12 & (uint32_t) ~n_cse60) | (uint32_t) (0 << (uint32_t) 13U)));
    
    uint32_t n_r13 = ivory_hw_io_read_u32((uint32_t) 1073874952U);
    
    /* reg modify gpioC->ospeed: setField gpio_ospeed_13 */
    ivory_hw_io_write_u32((uint32_t) 1073874952U, (uint32_t) ((uint32_t) (n_cse55 & n_r13) | (uint32_t) (n_cse23 << (uint32_t) 26U)));
    
    uint32_t n_r14 = ivory_hw_io_read_u32((uint32_t) 1073874968U);
    
    /* reg modify gpioC->bsrr: setBit gpio_bs_13 */
    ivory_hw_io_write_u32((uint32_t) 1073874968U, (uint32_t) (n_cse60 | n_r14));
    /* assert Accel Mag CS */
    /* Set gpioC15 to assert output */
    ;
    
    uint32_t n_r15 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioc */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse51 | n_r15));
    
    uint32_t n_r16 = ivory_hw_io_read_u32((uint32_t) 1073874944U);
    
    /* reg modify gpioC->mode: setField gpio_mode_15 */
    ;
    
    uint32_t n_cse75 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 30U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874944U, (uint32_t) ((uint32_t) (n_r16 & n_cse75) | (uint32_t) (n_cse9 << (uint32_t) 30U)));
    
    uint32_t n_r17 = ivory_hw_io_read_u32((uint32_t) 1073874948U);
    
    /* reg modify gpioC->otype: setField gpio_otype_15 */
    ;
    
    uint32_t n_cse80 = (uint32_t) ((uint32_t) 1U << (uint32_t) 15U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874948U, (uint32_t) ((uint32_t) (n_r17 & (uint32_t) ~n_cse80) | (uint32_t) (0 << (uint32_t) 15U)));
    
    uint32_t n_r18 = ivory_hw_io_read_u32((uint32_t) 1073874952U);
    
    /* reg modify gpioC->ospeed: setField gpio_ospeed_15 */
    ivory_hw_io_write_u32((uint32_t) 1073874952U, (uint32_t) ((uint32_t) (n_cse75 & n_r18) | (uint32_t) (n_cse23 << (uint32_t) 30U)));
    
    uint32_t n_r19 = ivory_hw_io_read_u32((uint32_t) 1073874968U);
    
    /* reg modify gpioC->bsrr: setBit gpio_bs_15 */
    ivory_hw_io_write_u32((uint32_t) 1073874968U, (uint32_t) (n_cse80 | n_r19));
    /* assert MPU6000 CS */
    /* Set gpioC2 to assert output */
    ;
    
    uint32_t n_r20 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioc */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse51 | n_r20));
    
    uint32_t n_r21 = ivory_hw_io_read_u32((uint32_t) 1073874944U);
    
    /* reg modify gpioC->mode: setField gpio_mode_2 */
    ;
    
    uint32_t n_cse95 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 4U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874944U, (uint32_t) ((uint32_t) (n_r21 & n_cse95) | (uint32_t) (n_cse9 << (uint32_t) 4U)));
    
    uint32_t n_r22 = ivory_hw_io_read_u32((uint32_t) 1073874948U);
    
    /* reg modify gpioC->otype: setField gpio_otype_2 */
    ivory_hw_io_write_u32((uint32_t) 1073874948U, (uint32_t) ((uint32_t) (n_r22 & (uint32_t) ~n_cse51) | (uint32_t) (0 << (uint32_t) 2U)));
    
    uint32_t n_r23 = ivory_hw_io_read_u32((uint32_t) 1073874952U);
    
    /* reg modify gpioC->ospeed: setField gpio_ospeed_2 */
    ivory_hw_io_write_u32((uint32_t) 1073874952U, (uint32_t) ((uint32_t) (n_cse95 & n_r23) | (uint32_t) (n_cse23 << (uint32_t) 4U)));
    
    uint32_t n_r24 = ivory_hw_io_read_u32((uint32_t) 1073874968U);
    
    /* reg modify gpioC->bsrr: setBit gpio_bs_2 */
    ivory_hw_io_write_u32((uint32_t) 1073874968U, (uint32_t) (n_cse51 | n_r24));
    /* assert Baro CS */
    /* Set gpioD7 to assert output */
    ;
    
    uint32_t n_r25 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiod */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse13 | n_r25));
    
    uint32_t n_r26 = ivory_hw_io_read_u32((uint32_t) 1073875968U);
    
    /* reg modify gpioD->mode: setField gpio_mode_7 */
    ;
    
    uint32_t n_cse114 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 14U);
    
    ivory_hw_io_write_u32((uint32_t) 1073875968U, (uint32_t) ((uint32_t) (n_r26 & n_cse114) | (uint32_t) (n_cse9 << (uint32_t) 14U)));
    
    uint32_t n_r27 = ivory_hw_io_read_u32((uint32_t) 1073875972U);
    
    /* reg modify gpioD->otype: setField gpio_otype_7 */
    ;
    
    uint32_t n_cse119 = (uint32_t) ((uint32_t) 1U << (uint32_t) 7U);
    
    ivory_hw_io_write_u32((uint32_t) 1073875972U, (uint32_t) ((uint32_t) (n_r27 & (uint32_t) ~n_cse119) | (uint32_t) (0 << (uint32_t) 7U)));
    
    uint32_t n_r28 = ivory_hw_io_read_u32((uint32_t) 1073875976U);
    
    /* reg modify gpioD->ospeed: setField gpio_ospeed_7 */
    ivory_hw_io_write_u32((uint32_t) 1073875976U, (uint32_t) ((uint32_t) (n_cse114 & n_r28) | (uint32_t) (n_cse23 << (uint32_t) 14U)));
    
    uint32_t n_r29 = ivory_hw_io_read_u32((uint32_t) 1073875992U);
    
    /* reg modify gpioD->bsrr: setBit gpio_bs_7 */
    ivory_hw_io_write_u32((uint32_t) 1073875992U, (uint32_t) (n_cse119 | n_r29));
    /* assert FRAM CS */
    /* Set gpioD10 to assert output */
    ;
    
    uint32_t n_r30 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiod */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse13 | n_r30));
    
    uint32_t n_r31 = ivory_hw_io_read_u32((uint32_t) 1073875968U);
    
    /* reg modify gpioD->mode: setField gpio_mode_10 */
    ;
    
    uint32_t n_cse134 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 20U);
    
    ivory_hw_io_write_u32((uint32_t) 1073875968U, (uint32_t) ((uint32_t) (n_r31 & n_cse134) | (uint32_t) (n_cse9 << (uint32_t) 20U)));
    
    uint32_t n_r32 = ivory_hw_io_read_u32((uint32_t) 1073875972U);
    
    /* reg modify gpioD->otype: setField gpio_otype_10 */
    ;
    
    uint32_t n_cse139 = (uint32_t) ((uint32_t) 1U << (uint32_t) 10U);
    
    ivory_hw_io_write_u32((uint32_t) 1073875972U, (uint32_t) ((uint32_t) (n_r32 & (uint32_t) ~n_cse139) | (uint32_t) (0 << (uint32_t) 10U)));
    
    uint32_t n_r33 = ivory_hw_io_read_u32((uint32_t) 1073875976U);
    
    /* reg modify gpioD->ospeed: setField gpio_ospeed_10 */
    ivory_hw_io_write_u32((uint32_t) 1073875976U, (uint32_t) ((uint32_t) (n_cse134 & n_r33) | (uint32_t) (n_cse23 << (uint32_t) 20U)));
    
    uint32_t n_r34 = ivory_hw_io_read_u32((uint32_t) 1073875992U);
    
    /* reg modify gpioD->bsrr: setBit gpio_bs_10 */
    ivory_hw_io_write_u32((uint32_t) 1073875992U, (uint32_t) (n_cse139 | n_r34));
    emitter_init_2_chan_161(n_var0);
}

void callback_request_4_thread_init(const struct spi_transaction_request *n_var0)
{
    bool n_deref0 = done;
    
    if (n_deref0) {
        done = false;
        reqbuffer = *n_var0;
        
        int32_t n_deref1 = reqbuffer.tx_len;
        
        reqbufferpos = (int32_t) 0;
        resbufferpos = (int32_t) 0;
        resbuffer.rx_idx = n_deref1;
        
        uint8_t n_deref2 = reqbuffer.tx_buf[(int32_t) 0];
        
        reqbufferpos = (int32_t) 1;
        /* selecting device: */
        ;
        
        uint8_t n_deref3 = reqbuffer.tx_device;
        
        ASSERTS((bool) (n_deref3 < (uint8_t) 4U));
        if ((bool) (0 == n_deref3)) {
            mpu6k_devicebegin();
        } else {
            if ((bool) ((uint8_t) 1U == n_deref3)) {
                lsm303d_devicebegin();
            } else {
                if ((bool) ((uint8_t) 2U == n_deref3)) {
                    ms5611_devicebegin();
                } else {
                    if ((bool) (n_deref3 == (uint8_t) 3U)) {
                        l3gd20_devicebegin();
                    }
                }
            }
        }
        /* end selecting configured device */
        ;
        /* reg set spi1->dr: setField spi_dr_data */
        ;
        ivory_hw_io_write_u16((uint32_t) 1073819660U, (uint16_t) ((uint16_t) n_deref2 << 0));
        
        uint16_t n_r4 = ivory_hw_io_read_u16((uint32_t) 1073819652U);
        
        /* reg modify spi1->cr2: setBit spi_cr2_txeie */
        ;
        ivory_hw_io_write_u16((uint32_t) 1073819652U, (uint16_t) (n_r4 | (uint16_t) ((uint16_t) 1U << (uint16_t) 7U)));
    }
}

void callback_initialize_hardware_thread_init(const int64_t *n_var0)
{
    uint32_t n_r0 = ivory_hw_io_read_u32((uint32_t) 1073887300U);
    
    /* reg modify rcc_apb2enr: setBit rcc_apb2en_spi1 */
    ivory_hw_io_write_u32((uint32_t) 1073887300U, (uint32_t) (n_r0 | (uint32_t) ((uint32_t) 1U << (uint32_t) 12U)));
    
    uint16_t n_r1 = ivory_hw_io_read_u16((uint32_t) 1073819648U);
    
    /* reg modify spi1->cr1: clearBit spi_cr1_bidimode, clearBit spi_cr1_bidioe, clearBit spi_cr1_crcen, clearBit spi_cr1_crcnext, clearBit spi_cr1_dff, clearBit spi_cr1_rxonly, clearBit spi_cr1_ssm, clearBit spi_cr1_ssi, clearBit spi_cr1_lsbfirst, clearBit spi_cr1_spe, setField spi_cr1_br, clearBit spi_cr1_mstr, clearBit spi_cr1_cpol, clearBit spi_cr1_cpha */
    ;
    
    uint16_t n_cse29 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 7U);
    uint16_t n_cse32 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 6U);
    uint16_t n_cse41 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 2U);
    uint16_t n_cse44 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 1U);
    uint16_t n_cse47 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << 0);
    
    ivory_hw_io_write_u16((uint32_t) 1073819648U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) (n_r1 & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 15U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 14U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U <<
                                                                                                                                                                                                                                                                                                                                                                                             (uint16_t) 13U)) &
                                                                                                                                                                                                  (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 12U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 11U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 10U)) &
                                                                                                                                                              (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 9U)) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 8U)) & n_cse29) & n_cse32) & (uint16_t) ~(uint16_t) ((uint16_t) 7U << (uint16_t) 3U)) | (uint16_t) (0 << (uint16_t) 3U)) &
                                                                                      n_cse41) & n_cse44) & n_cse47));
    
    uint16_t n_r2 = ivory_hw_io_read_u16((uint32_t) 1073819652U);
    
    /* reg modify spi1->cr2: clearBit spi_cr2_txeie, clearBit spi_cr2_rxneie, clearBit spi_cr2_errie, clearBit spi_cr2_ssoe, clearBit spi_cr2_txdmaen, clearBit spi_cr2_rxdmaen */
    ivory_hw_io_write_u16((uint32_t) 1073819652U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) (n_cse47 & n_cse44) & n_cse41) & n_cse32) & n_cse29) & n_r2) & (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 5U)));
    /* init spi input pin gpioA6 */
    ;
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioa */
    ;
    
    uint32_t n_cse58 = (uint32_t) ((uint32_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse58 | n_r3));
    
    uint32_t n_r4 = ivory_hw_io_read_u32((uint32_t) 1073872928U);
    
    /* reg modify gpioA->afrl: setField gpio_afrl_6 */
    ;
    
    uint32_t n_cse67 = (uint32_t) (uint8_t) ((uint8_t) 5U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073872928U, (uint32_t) ((uint32_t) (n_r4 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 24U)) | (uint32_t) (n_cse67 << (uint32_t) 24U)));
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073872896U);
    
    /* reg modify gpioA->mode: setField gpio_mode_6 */
    ;
    
    uint32_t n_cse72 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 12U);
    uint32_t n_cse76 = (uint32_t) (uint8_t) ((uint8_t) 2U << 0);
    uint32_t n_cse77 = (uint32_t) (n_cse76 << (uint32_t) 12U);
    
    ivory_hw_io_write_u32((uint32_t) 1073872896U, (uint32_t) ((uint32_t) (n_r5 & n_cse72) | n_cse77));
    
    uint32_t n_r6 = ivory_hw_io_read_u32((uint32_t) 1073872908U);
    
    /* reg modify gpioA->pupd: setField gpio_pupd_6 */
    ivory_hw_io_write_u32((uint32_t) 1073872908U, (uint32_t) ((uint32_t) (n_cse72 & n_r6) | (uint32_t) (0 << (uint32_t) 12U)));
    
    uint32_t n_r7 = ivory_hw_io_read_u32((uint32_t) 1073872904U);
    
    /* reg modify gpioA->ospeed: setField gpio_ospeed_6 */
    ivory_hw_io_write_u32((uint32_t) 1073872904U, (uint32_t) (n_cse77 | (uint32_t) (n_cse72 & n_r7)));
    /* init spi output pin gpioA7 */
    ;
    
    uint32_t n_r8 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioa */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse58 | n_r8));
    
    uint32_t n_r9 = ivory_hw_io_read_u32((uint32_t) 1073872928U);
    
    /* reg modify gpioA->afrl: setField gpio_afrl_7 */
    ivory_hw_io_write_u32((uint32_t) 1073872928U, (uint32_t) ((uint32_t) (n_r9 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 28U)) | (uint32_t) (n_cse67 << (uint32_t) 28U)));
    
    uint32_t n_r10 = ivory_hw_io_read_u32((uint32_t) 1073872896U);
    
    /* reg modify gpioA->mode: setField gpio_mode_7 */
    ;
    
    uint32_t n_cse97 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 14U);
    uint32_t n_cse99 = (uint32_t) (n_cse76 << (uint32_t) 14U);
    
    ivory_hw_io_write_u32((uint32_t) 1073872896U, (uint32_t) ((uint32_t) (n_r10 & n_cse97) | n_cse99));
    
    uint32_t n_r11 = ivory_hw_io_read_u32((uint32_t) 1073872900U);
    
    /* reg modify gpioA->otype: setField gpio_otype_7 */
    ;
    
    uint32_t n_cse101 = (uint32_t) ((uint32_t) 1U << (uint32_t) 7U);
    uint32_t n_cse102 = (uint32_t) ~n_cse101;
    uint32_t n_cse105 = (uint32_t) (0 << (uint32_t) 7U);
    
    ivory_hw_io_write_u32((uint32_t) 1073872900U, (uint32_t) ((uint32_t) (n_cse102 & n_r11) | n_cse105));
    
    uint32_t n_r12 = ivory_hw_io_read_u32((uint32_t) 1073872904U);
    
    /* reg modify gpioA->ospeed: setField gpio_ospeed_7 */
    ivory_hw_io_write_u32((uint32_t) 1073872904U, (uint32_t) (n_cse99 | (uint32_t) (n_cse97 & n_r12)));
    /* init spi output pin gpioA5 */
    ;
    
    uint32_t n_r13 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioa */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse58 | n_r13));
    
    uint32_t n_r14 = ivory_hw_io_read_u32((uint32_t) 1073872928U);
    
    /* reg modify gpioA->afrl: setField gpio_afrl_5 */
    ivory_hw_io_write_u32((uint32_t) 1073872928U, (uint32_t) ((uint32_t) (n_r14 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 20U)) | (uint32_t) (n_cse67 << (uint32_t) 20U)));
    
    uint32_t n_r15 = ivory_hw_io_read_u32((uint32_t) 1073872896U);
    
    /* reg modify gpioA->mode: setField gpio_mode_5 */
    ;
    
    uint32_t n_cse120 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 10U);
    uint32_t n_cse122 = (uint32_t) (n_cse76 << (uint32_t) 10U);
    
    ivory_hw_io_write_u32((uint32_t) 1073872896U, (uint32_t) ((uint32_t) (n_r15 & n_cse120) | n_cse122));
    
    uint32_t n_r16 = ivory_hw_io_read_u32((uint32_t) 1073872900U);
    
    /* reg modify gpioA->otype: setField gpio_otype_5 */
    ivory_hw_io_write_u32((uint32_t) 1073872900U, (uint32_t) ((uint32_t) ((uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 5U) & n_r16) | (uint32_t) (0 << (uint32_t) 5U)));
    
    uint32_t n_r17 = ivory_hw_io_read_u32((uint32_t) 1073872904U);
    
    /* reg modify gpioA->ospeed: setField gpio_ospeed_5 */
    ivory_hw_io_write_u32((uint32_t) 1073872904U, (uint32_t) (n_cse122 | (uint32_t) (n_cse120 & n_r17)));
    
    uint32_t n_r18 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioc */
    ;
    
    uint32_t n_cse133 = (uint32_t) ((uint32_t) 1U << (uint32_t) 2U);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse133 | n_r18));
    
    uint32_t n_r19 = ivory_hw_io_read_u32((uint32_t) 1073874968U);
    
    /* reg modify gpioC->bsrr: setBit gpio_bs_2 */
    ivory_hw_io_write_u32((uint32_t) 1073874968U, (uint32_t) (n_cse133 | n_r19));
    
    uint32_t n_r20 = ivory_hw_io_read_u32((uint32_t) 1073874944U);
    
    /* reg modify gpioC->mode: setField gpio_mode_2 */
    ;
    
    uint32_t n_cse140 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 4U);
    uint32_t n_cse144 = (uint32_t) (uint8_t) ((uint8_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073874944U, (uint32_t) ((uint32_t) (n_r20 & n_cse140) | (uint32_t) (n_cse144 << (uint32_t) 4U)));
    
    uint32_t n_r21 = ivory_hw_io_read_u32((uint32_t) 1073874948U);
    
    /* reg modify gpioC->otype: setField gpio_otype_2 */
    ivory_hw_io_write_u32((uint32_t) 1073874948U, (uint32_t) ((uint32_t) ((uint32_t) ~n_cse133 & n_r21) | (uint32_t) (0 << (uint32_t) 2U)));
    
    uint32_t n_r22 = ivory_hw_io_read_u32((uint32_t) 1073874952U);
    
    /* reg modify gpioC->ospeed: setField gpio_ospeed_2 */
    ivory_hw_io_write_u32((uint32_t) 1073874952U, (uint32_t) ((uint32_t) (n_cse140 & n_r22) | (uint32_t) (0 << (uint32_t) 4U)));
    
    uint32_t n_r23 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioc */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse133 | n_r23));
    
    uint32_t n_r24 = ivory_hw_io_read_u32((uint32_t) 1073874968U);
    
    /* reg modify gpioC->bsrr: setBit gpio_bs_15 */
    ;
    
    uint32_t n_cse158 = (uint32_t) ((uint32_t) 1U << (uint32_t) 15U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874968U, (uint32_t) (n_cse158 | n_r24));
    
    uint32_t n_r25 = ivory_hw_io_read_u32((uint32_t) 1073874944U);
    
    /* reg modify gpioC->mode: setField gpio_mode_15 */
    ;
    
    uint32_t n_cse163 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 30U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874944U, (uint32_t) ((uint32_t) (n_r25 & n_cse163) | (uint32_t) (n_cse144 << (uint32_t) 30U)));
    
    uint32_t n_r26 = ivory_hw_io_read_u32((uint32_t) 1073874948U);
    
    /* reg modify gpioC->otype: setField gpio_otype_15 */
    ivory_hw_io_write_u32((uint32_t) 1073874948U, (uint32_t) ((uint32_t) ((uint32_t) ~n_cse158 & n_r26) | (uint32_t) (0 << (uint32_t) 15U)));
    
    uint32_t n_r27 = ivory_hw_io_read_u32((uint32_t) 1073874952U);
    
    /* reg modify gpioC->ospeed: setField gpio_ospeed_15 */
    ivory_hw_io_write_u32((uint32_t) 1073874952U, (uint32_t) ((uint32_t) (n_cse163 & n_r27) | (uint32_t) (0 << (uint32_t) 30U)));
    
    uint32_t n_r28 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiod */
    ;
    
    uint32_t n_cse177 = (uint32_t) ((uint32_t) 1U << (uint32_t) 3U);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r28 | n_cse177));
    
    uint32_t n_r29 = ivory_hw_io_read_u32((uint32_t) 1073875992U);
    
    /* reg modify gpioD->bsrr: setBit gpio_bs_7 */
    ivory_hw_io_write_u32((uint32_t) 1073875992U, (uint32_t) (n_cse101 | n_r29));
    
    uint32_t n_r30 = ivory_hw_io_read_u32((uint32_t) 1073875968U);
    
    /* reg modify gpioD->mode: setField gpio_mode_7 */
    ivory_hw_io_write_u32((uint32_t) 1073875968U, (uint32_t) ((uint32_t) (n_cse97 & n_r30) | (uint32_t) (n_cse144 << (uint32_t) 14U)));
    
    uint32_t n_r31 = ivory_hw_io_read_u32((uint32_t) 1073875972U);
    
    /* reg modify gpioD->otype: setField gpio_otype_7 */
    ivory_hw_io_write_u32((uint32_t) 1073875972U, (uint32_t) (n_cse105 | (uint32_t) (n_cse102 & n_r31)));
    
    uint32_t n_r32 = ivory_hw_io_read_u32((uint32_t) 1073875976U);
    
    /* reg modify gpioD->ospeed: setField gpio_ospeed_7 */
    ivory_hw_io_write_u32((uint32_t) 1073875976U, (uint32_t) ((uint32_t) (n_cse97 & n_r32) | (uint32_t) (0 << (uint32_t) 14U)));
    
    uint32_t n_r33 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpioc */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse133 | n_r33));
    
    uint32_t n_r34 = ivory_hw_io_read_u32((uint32_t) 1073874968U);
    
    /* reg modify gpioC->bsrr: setBit gpio_bs_13 */
    ;
    
    uint32_t n_cse194 = (uint32_t) ((uint32_t) 1U << (uint32_t) 13U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874968U, (uint32_t) (n_cse194 | n_r34));
    
    uint32_t n_r35 = ivory_hw_io_read_u32((uint32_t) 1073874944U);
    
    /* reg modify gpioC->mode: setField gpio_mode_13 */
    ;
    
    uint32_t n_cse199 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 26U);
    
    ivory_hw_io_write_u32((uint32_t) 1073874944U, (uint32_t) ((uint32_t) (n_r35 & n_cse199) | (uint32_t) (n_cse144 << (uint32_t) 26U)));
    
    uint32_t n_r36 = ivory_hw_io_read_u32((uint32_t) 1073874948U);
    
    /* reg modify gpioC->otype: setField gpio_otype_13 */
    ivory_hw_io_write_u32((uint32_t) 1073874948U, (uint32_t) ((uint32_t) ((uint32_t) ~n_cse194 & n_r36) | (uint32_t) (0 << (uint32_t) 13U)));
    
    uint32_t n_r37 = ivory_hw_io_read_u32((uint32_t) 1073874952U);
    
    /* reg modify gpioC->ospeed: setField gpio_ospeed_13 */
    ivory_hw_io_write_u32((uint32_t) 1073874952U, (uint32_t) ((uint32_t) (n_cse199 & n_r37) | (uint32_t) (0 << (uint32_t) 26U)));
    done = true;
    emitter_initialize_hardware_chan_160(n_var0);
    /* reg set nvic_iser1: setBit nvic_iser_setena.[3] */
    ivory_hw_io_write_u32((uint32_t) 3758153988U, n_cse177);
}

void callback_write_gps_output_attr_thread_init(const struct position_sample *n_var0)
{
    emitter_write_gps_output_attr_chan_37(n_var0);
}

void callback_ublox_init_thread_init(const int64_t *n_var0)
{
    int64_t n_r0 = tower_get_time();
    
    position_1.time = n_r0;
    position_1.fix = (uint8_t) 0U;
    emitter_ublox_init_chan_147(&position_1);
}

void callback_gps_output_attr_update_thread_init(const struct position_sample *n_var0)
{
    gps_output_attr = *n_var0;
}

void callback_mag_output_attr_update_thread_init(const struct magnetometer_sample *n_var0)
{
    mag_output_attr = *n_var0;
}

void callback_baro_output_attr_update_thread_init(const struct barometer_sample *n_var0)
{
    baro_output_attr = *n_var0;
}

void callback_accel_output_attr_update_thread_init(const struct accelerometer_sample *n_var0)
{
    accel_output_attr = *n_var0;
}

void callback_gyro_output_attr_update_thread_init(const struct gyroscope_sample *n_var0)
{
    gyro_output_attr = *n_var0;
}

void callback_sensors_output_attr_update_thread_init(const struct sensors_result *n_var0)
{
    sensors_output_attr = *n_var0;
}

void callback_rgb_led_attr_update_thread_init(const struct rgb_led_setting *n_var0)
{
    rgb_led_attr = *n_var0;
}

void callback_can_init_2_thread_init(const int64_t *n_var0)
{
    uint32_t n_r0 = ivory_hw_io_read_u32((uint32_t) 1073887296U);
    
    /* reg modify rcc_apb1enr: setBit rcc_apb1en_can1 */
    ;
    
    uint32_t n_cse1 = (uint32_t) ((uint32_t) 1U << (uint32_t) 25U);
    
    ivory_hw_io_write_u32((uint32_t) 1073887296U, (uint32_t) (n_r0 | n_cse1));
    
    uint32_t n_r1 = ivory_hw_io_read_u32((uint32_t) 1073767936U);
    
    /* reg modify can->fmr: setBit can_fmr_finit, setField can_fmr_can2sb */
    ;
    
    uint32_t n_cse4 = (uint32_t) ((uint32_t) 1U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073767936U, (uint32_t) ((uint32_t) ((uint32_t) (n_r1 | n_cse4) & (uint32_t) ~(uint32_t) ((uint32_t) 63U << (uint32_t) 8U)) | (uint32_t) ((uint32_t) 1U << (uint32_t) 8U)));
    
    uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073767964U);
    
    /* reg modify can->fa1r: clearBit can_fa1r_fact.[0], clearBit can_fa1r_fact.[1], clearBit can_fa1r_fact.[2], clearBit can_fa1r_fact.[3], clearBit can_fa1r_fact.[4], clearBit can_fa1r_fact.[5], clearBit can_fa1r_fact.[6], clearBit can_fa1r_fact.[7], clearBit can_fa1r_fact.[8], clearBit can_fa1r_fact.[9], clearBit can_fa1r_fact.[10], clearBit can_fa1r_fact.[11], clearBit can_fa1r_fact.[12], clearBit can_fa1r_fact.[13], clearBit can_fa1r_fact.[14], clearBit can_fa1r_fact.[15], clearBit can_fa1r_fact.[16], clearBit can_fa1r_fact.[17], clearBit can_fa1r_fact.[18], clearBit can_fa1r_fact.[19], clearBit can_fa1r_fact.[20], clearBit can_fa1r_fact.[21], clearBit can_fa1r_fact.[22], clearBit can_fa1r_fact.[23], clearBit can_fa1r_fact.[24], clearBit can_fa1r_fact.[25], clearBit can_fa1r_fact.[26], clearBit can_fa1r_fact.[27] */
    ;
    
    uint32_t n_cse14 = (uint32_t) ~n_cse4;
    uint32_t n_cse17 = (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 1U);
    uint32_t n_cse20 = (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 2U);
    
    ivory_hw_io_write_u32((uint32_t) 1073767964U, (uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) (n_r2 &
                                                                                                                                                                                                                                                                                                                                                                                                  n_cse14) &
                                                                                                                                                                                                                                                                                                                                                                                      n_cse17) & n_cse20) &
                                                                                                                                                                                                                                                                                                                                                              (uint32_t) ~(uint32_t) ((uint32_t) 1U <<
                                                                                                                                                                                                                                                                                                                                                                                      (uint32_t) 3U)) &
                                                                                                                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 4U)) &
                                                                                                                                                                                                                                                                                                                                      (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 5U)) &
                                                                                                                                                                                                                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 6U)) &
                                                                                                                                                                                                                                                                                                              (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 7U)) &
                                                                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 8U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U <<
                                                                                                                                                                                                                                                                                                                                                                                     (uint32_t) 9U)) &
                                                                                                                                                                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 10U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 11U)) &
                                                                                                                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 12U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 13U)) &
                                                                                                                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 14U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 15U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 16U)) &
                                                                                                                                                                                      (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 17U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 18U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 19U)) &
                                                                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 20U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 21U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 22U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 23U)) &
                                                                                                  (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 24U)) & (uint32_t) ~n_cse1) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 26U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 27U)));
    /* reg set can->f0r032: setField can_firx32_stid, setField can_firx32_exid, clearBit can_firx32_ide, clearBit can_firx32_rtr */
    ;
    
    uint32_t n_cse111 = (uint32_t) ((uint32_t) (n_cse17 & n_cse20) & (uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) 0 << (uint32_t) 21U) & (uint32_t) ~(uint32_t) ((uint32_t) 262143U << (uint32_t) 3U)) | (uint32_t) (0 << (uint32_t) 3U)));
    
    ivory_hw_io_write_u32((uint32_t) 1073768000U, n_cse111);
    /* reg set can->f0r132: setField can_firx32_stid, setField can_firx32_exid, clearBit can_firx32_ide, clearBit can_firx32_rtr */
    ivory_hw_io_write_u32((uint32_t) 1073768004U, n_cse111);
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073767940U);
    
    /* reg modify can->fm1r: clearBit can_fm1r_fbm.[0] */
    ivory_hw_io_write_u32((uint32_t) 1073767940U, (uint32_t) (n_cse14 & n_r3));
    
    uint32_t n_r4 = ivory_hw_io_read_u32((uint32_t) 1073767956U);
    
    /* reg modify can->ffa1r: clearBit can_ffa1r_ffa.[0] */
    ivory_hw_io_write_u32((uint32_t) 1073767956U, (uint32_t) (n_cse14 & n_r4));
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073767948U);
    
    /* reg modify can->fs1r: setBit can_fs1r_fsc.[0] */
    ivory_hw_io_write_u32((uint32_t) 1073767948U, (uint32_t) (n_cse4 | n_r5));
    
    uint32_t n_r6 = ivory_hw_io_read_u32((uint32_t) 1073767964U);
    
    /* reg modify can->fa1r: setBit can_fa1r_fact.[0] */
    ivory_hw_io_write_u32((uint32_t) 1073767964U, (uint32_t) (n_cse4 | n_r6));
    
    uint32_t n_r7 = ivory_hw_io_read_u32((uint32_t) 1073767936U);
    
    /* reg modify can->fmr: clearBit can_fmr_finit */
    ivory_hw_io_write_u32((uint32_t) 1073767936U, (uint32_t) (n_cse14 & n_r7));
}

void callback_init_thread_init(const int64_t *n_var0)
{
    uint32_t n_r0 = ivory_hw_io_read_u32((uint32_t) 1073887296U);
    
    /* reg modify rcc_apb1enr: setBit rcc_apb1en_can1 */
    ivory_hw_io_write_u32((uint32_t) 1073887296U, (uint32_t) (n_r0 | (uint32_t) ((uint32_t) 1U << (uint32_t) 25U)));
    
    uint32_t n_r1 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiod */
    ;
    
    uint32_t n_cse4 = (uint32_t) ((uint32_t) 1U << (uint32_t) 3U);
    
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_r1 | n_cse4));
    
    uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073875972U);
    
    /* reg modify gpioD->otype: setField gpio_otype_0 */
    ;
    
    uint32_t n_cse7 = (uint32_t) ((uint32_t) 1U << 0);
    uint32_t n_cse8 = (uint32_t) ~n_cse7;
    uint32_t n_cse11 = (uint32_t) (0 << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073875972U, (uint32_t) ((uint32_t) (n_r2 & n_cse8) | n_cse11));
    
    uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073875980U);
    
    /* reg modify gpioD->pupd: setField gpio_pupd_0 */
    ;
    
    uint32_t n_cse15 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073875980U, (uint32_t) (n_cse11 | (uint32_t) (n_r3 & n_cse15)));
    
    uint32_t n_r4 = ivory_hw_io_read_u32((uint32_t) 1073876000U);
    
    /* reg modify gpioD->afrl: setField gpio_afrl_0 */
    ;
    
    uint32_t n_cse24 = (uint32_t) (uint8_t) ((uint8_t) 9U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073876000U, (uint32_t) ((uint32_t) (n_r4 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << 0)) | (uint32_t) (n_cse24 << 0)));
    
    uint32_t n_r5 = ivory_hw_io_read_u32((uint32_t) 1073875968U);
    
    /* reg modify gpioD->mode: setField gpio_mode_0 */
    ;
    
    uint32_t n_cse31 = (uint32_t) (uint8_t) ((uint8_t) 2U << 0);
    
    ivory_hw_io_write_u32((uint32_t) 1073875968U, (uint32_t) ((uint32_t) (n_cse15 & n_r5) | (uint32_t) (n_cse31 << 0)));
    
    uint32_t n_r6 = ivory_hw_io_read_u32((uint32_t) 1073887280U);
    
    /* reg modify rcc_ahb1enr: setBit rcc_ahb1en_gpiod */
    ivory_hw_io_write_u32((uint32_t) 1073887280U, (uint32_t) (n_cse4 | n_r6));
    
    uint32_t n_r7 = ivory_hw_io_read_u32((uint32_t) 1073875972U);
    
    /* reg modify gpioD->otype: setField gpio_otype_1 */
    ;
    
    uint32_t n_cse37 = (uint32_t) ((uint32_t) 1U << (uint32_t) 1U);
    uint32_t n_cse38 = (uint32_t) ~n_cse37;
    
    ivory_hw_io_write_u32((uint32_t) 1073875972U, (uint32_t) ((uint32_t) (n_r7 & n_cse38) | (uint32_t) (0 << (uint32_t) 1U)));
    
    uint32_t n_r8 = ivory_hw_io_read_u32((uint32_t) 1073875980U);
    
    /* reg modify gpioD->pupd: setField gpio_pupd_1 */
    ;
    
    uint32_t n_cse44 = (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 2U);
    
    ivory_hw_io_write_u32((uint32_t) 1073875980U, (uint32_t) ((uint32_t) (n_r8 & n_cse44) | (uint32_t) (0 << (uint32_t) 2U)));
    
    uint32_t n_r9 = ivory_hw_io_read_u32((uint32_t) 1073876000U);
    
    /* reg modify gpioD->afrl: setField gpio_afrl_1 */
    ivory_hw_io_write_u32((uint32_t) 1073876000U, (uint32_t) ((uint32_t) (n_r9 & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 4U)) | (uint32_t) (n_cse24 << (uint32_t) 4U)));
    
    uint32_t n_r10 = ivory_hw_io_read_u32((uint32_t) 1073875968U);
    
    /* reg modify gpioD->mode: setField gpio_mode_1 */
    ivory_hw_io_write_u32((uint32_t) 1073875968U, (uint32_t) ((uint32_t) (n_cse44 & n_r10) | (uint32_t) (n_cse31 << (uint32_t) 2U)));
    
    uint32_t n_r11 = ivory_hw_io_read_u32((uint32_t) 1073767424U);
    
    /* reg modify can1->mcr: setBit can_mcr_inrq, clearBit can_mcr_sleep */
    ivory_hw_io_write_u32((uint32_t) 1073767424U, (uint32_t) (n_cse38 & (uint32_t) (n_cse7 | n_r11)));
    {
        int forever_loop __attribute__((unused));
        
        for (forever_loop = 0; IFOREVER; IFOREVER_INC) {
            /* reg get can1->msr:  */
            ;
            
            uint32_t n_r12 = ivory_hw_io_read_u32((uint32_t) 1073767428U);
            
            if ((bool) ((uint8_t) (uint16_t) ((uint16_t) (uint32_t) ((uint32_t) (n_r12 >> 0) & (uint32_t) 1U) & (uint16_t) 255U) != 0)) {
                break;
            }
        }
    }
    
    uint32_t n_r13 = ivory_hw_io_read_u32((uint32_t) 1073767452U);
    
    /* reg modify can1->btr: clearBit can_btr_silm, clearBit can_btr_lbkm, setField can_btr_sjw, setField can_btr_ts2, setField can_btr_ts1, setField can_btr_brp */
    ivory_hw_io_write_u32((uint32_t) 1073767452U, (uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) ((uint32_t) (n_r13 & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 31U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1U << (uint32_t) 30U)) & (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 24U)) | (uint32_t) ((uint32_t) 0 <<
                                                                                                                                                                                                                                                                                                                                                                                  (uint32_t) 24U)) &
                                                                                                                          (uint32_t) ~(uint32_t) ((uint32_t) 7U << (uint32_t) 20U)) | (uint32_t) ((uint32_t) 0 << (uint32_t) 20U)) & (uint32_t) ~(uint32_t) ((uint32_t) 15U << (uint32_t) 16U)) | (uint32_t) ((uint32_t) 5U << (uint32_t) 16U)) & (uint32_t) ~(uint32_t) ((uint32_t) 1023U << 0)) |
                                                              (uint32_t) ((uint32_t) 41U << 0)));
    
    uint32_t n_r14 = ivory_hw_io_read_u32((uint32_t) 1073767424U);
    
    /* reg modify can1->mcr: clearBit can_mcr_inrq */
    ivory_hw_io_write_u32((uint32_t) 1073767424U, (uint32_t) (n_cse8 & n_r14));
    /* reg set can1->msr: setBit can_msr_slaki, setBit can_msr_wkui, setBit can_msr_erri */
    ;
    
    uint32_t n_cse108 = (uint32_t) ((uint32_t) 1U << (uint32_t) 4U);
    
    ivory_hw_io_write_u32((uint32_t) 1073767428U, (uint32_t) ((uint32_t) (n_cse4 | n_cse108) | (uint32_t) ((uint32_t) 1U << (uint32_t) 2U)));
    
    uint32_t n_r15 = ivory_hw_io_read_u32((uint32_t) 1073767444U);
    
    /* reg modify can1->ier: setBit can_ier_tmeie, setBit can_ier_fmpie0, setBit can_ier_fmpie1 */
    ivory_hw_io_write_u32((uint32_t) 1073767444U, (uint32_t) ((uint32_t) ((uint32_t) (n_cse108 | n_cse37) | n_cse7) | n_r15));
    /* reg set nvic_iser0: setBit nvic_iser_setena.[19] */
    ivory_hw_io_write_u32((uint32_t) 3758153984U, (uint32_t) ((uint32_t) 1U << (uint32_t) 19U));
    /* reg set nvic_iser0: setBit nvic_iser_setena.[20] */
    ivory_hw_io_write_u32((uint32_t) 3758153984U, (uint32_t) ((uint32_t) 1U << (uint32_t) 20U));
    /* reg set nvic_iser0: setBit nvic_iser_setena.[21] */
    ivory_hw_io_write_u32((uint32_t) 3758153984U, (uint32_t) ((uint32_t) 1U << (uint32_t) 21U));
}

void emitter_set_chan_190(const struct i2c_transaction_request *n_var0)
{
    emitter_set_chan_190_thread_init_emit(n_var0);
}

void emitter_i2c2_request_chan_191(const struct i2c_transaction_result *n_var0)
{
    emitter_i2c2_request_chan_191_thread_init_emit(n_var0);
}

void emitter_dmauart_hw_init_chan_151(const int64_t *n_var0)
{
    emitter_dmauart_hw_init_chan_151_thread_init_emit(n_var0);
}

void emitter_new_state_chan_29(const struct sensors_result *n_var0)
{
    emitter_new_state_chan_29_thread_init_emit(n_var0);
}

void emitter_att_est_gyro_chan_189(const struct AhrsMlkf *n_var0)
{
    emitter_att_est_gyro_chan_189_thread_init_emit(n_var0);
}

void emitter_att_est_mag_chan_189(const struct AhrsMlkf *n_var0)
{
    emitter_att_est_mag_chan_189_thread_init_emit(n_var0);
}

void emitter_att_est_accel_chan_189(const struct AhrsMlkf *n_var0)
{
    emitter_att_est_accel_chan_189_thread_init_emit(n_var0);
}

void emitter_write_mag_output_attr_chan_34(const struct magnetometer_sample *n_var0)
{
    emitter_write_mag_output_attr_chan_34_thread_init_emit(n_var0);
}

void emitter_write_gyro_output_attr_chan_30(const struct gyroscope_sample *n_var0)
{
    emitter_write_gyro_output_attr_chan_30_thread_init_emit(n_var0);
}

void emitter_write_baro_output_attr_chan_32(const struct barometer_sample *n_var0)
{
    emitter_write_baro_output_attr_chan_32_thread_init_emit(n_var0);
}

void emitter_write_accel_output_attr_chan_31(const struct accelerometer_sample *n_var0)
{
    emitter_write_accel_output_attr_chan_31_thread_init_emit(n_var0);
}

void emitter_motion_light_debug_2_chan_23(const struct rgb_led_setting *n_var0)
{
    emitter_motion_light_debug_2_chan_23_thread_init_emit(n_var0);
}

void emitter_detectMotion_2_accel_chan_188(const bool *n_var0)
{
    emitter_detectMotion_2_accel_chan_188_thread_init_emit(n_var0);
}

void emitter_spi1_scheduler_ready_chan_158(const struct spi_transaction_request *n_var0)
{
    emitter_spi1_scheduler_ready_chan_158_thread_init_emit(n_var0);
}

void emitter_spi1_scheduler_l3gd20_chan_158(const struct spi_transaction_request *n_var0)
{
    emitter_spi1_scheduler_l3gd20_chan_158_thread_init_emit(n_var0);
}

void emitter_spi1_scheduler_ms5611_chan_158(const struct spi_transaction_request *n_var0)
{
    emitter_spi1_scheduler_ms5611_chan_158_thread_init_emit(n_var0);
}

void emitter_spi1_scheduler_lsm303d_chan_158(const struct spi_transaction_request *n_var0)
{
    emitter_spi1_scheduler_lsm303d_chan_158_thread_init_emit(n_var0);
}

void emitter_spi1_scheduler_mpu6000_chan_158(const struct spi_transaction_request *n_var0)
{
    emitter_spi1_scheduler_mpu6000_chan_158_thread_init_emit(n_var0);
}

void emitter_ms5611_init_chan_178(const bool *n_var0)
{
    emitter_ms5611_init_chan_178_thread_init_emit(n_var0);
}

void emitter_ms5611_chan_175(const struct spi_transaction_request *n_var0)
{
    emitter_ms5611_chan_175_thread_init_emit(n_var0);
}

void emitter_ms5611_chan_177(const struct barometer_sample *n_var0)
{
    emitter_ms5611_chan_177_thread_init_emit(n_var0);
}

void emitter_lsm303d_coroutine_init_chan_174(const bool *n_var0)
{
    emitter_lsm303d_coroutine_init_chan_174_thread_init_emit(n_var0);
}

void emitter_lsm303d_coroutine_chan_170(const struct spi_transaction_request *n_var0)
{
    emitter_lsm303d_coroutine_chan_170_thread_init_emit(n_var0);
}

void emitter_lsm303d_coroutine_chan_172(const struct magnetometer_sample *n_var0)
{
    emitter_lsm303d_coroutine_chan_172_thread_init_emit(n_var0);
}

void emitter_mpu6000_init_chan_169(const bool *n_var0)
{
    emitter_mpu6000_init_chan_169_thread_init_emit(n_var0);
}

void emitter_mpu6000_chan_167(const struct spi_transaction_request *n_var0)
{
    emitter_mpu6000_chan_167_thread_init_emit(n_var0);
}

void emitter_mpu6000_chan_157(const struct gyroscope_sample *n_var0)
{
    emitter_mpu6000_chan_157_thread_init_emit(n_var0);
}

void emitter_mpu6000_chan_156(const struct accelerometer_sample *n_var0)
{
    emitter_mpu6000_chan_156_thread_init_emit(n_var0);
}

void emitter_l3gd20_init_chan_166(const bool *n_var0)
{
    emitter_l3gd20_init_chan_166_thread_init_emit(n_var0);
}

void emitter_l3gd20_chan_164(const struct spi_transaction_request *n_var0)
{
    emitter_l3gd20_chan_164_thread_init_emit(n_var0);
}

void emitter_l3gd20_chan_162(const int64_t *n_var0)
{
    emitter_l3gd20_chan_162_thread_init_emit(n_var0);
}

void emitter_init_2_chan_161(const int64_t *n_var0)
{
    emitter_init_2_chan_161_thread_init_emit(n_var0);
}

void emitter_initialize_hardware_chan_160(const int64_t *n_var0)
{
    emitter_initialize_hardware_chan_160_thread_init_emit(n_var0);
}

void emitter_write_gps_output_attr_chan_37(const struct position_sample *n_var0)
{
    emitter_write_gps_output_attr_chan_37_thread_init_emit(n_var0);
}

void emitter_ublox_init_chan_147(const struct position_sample *n_var0)
{
    emitter_ublox_init_chan_147_thread_init_emit(n_var0);
}
