/* This file has been autogenerated by Ivory
 * Compiler version  0.1.0.5
 */
#include "tower_user_thread_signal_I2C2_ER_IRQHandler.h"

static void emitter_i2c2_error_irq_chan_191(const struct i2c_transaction_result *n_var0);

void callback_i2c_response_thread_signal_I2C2_ER_IRQHandler(const struct i2c_transaction_result *n_var0)
{
    bool n_deref0 = expect_response;
    
    if (n_deref0) {
        uint8_t n_deref1 = n_var0->resultcode;
        
        if ((bool) (n_deref1 > 0)) {
            error = (uint8_t) 3U;
        }
    } else {
        error = (uint8_t) 2U;
    }
    expect_response = false;
}

void callback_i2c2_error_irq_thread_signal_I2C2_ER_IRQHandler(const int64_t *n_var0)
{
    /* reg get i2c2->sr1:  */
    ;
    
    uint16_t n_r0 = ivory_hw_io_read_u16((uint32_t) 1073764372U);
    
    /* reg get i2c2->sr2:  */
    ;
    
    uint16_t n_r1 = ivory_hw_io_read_u16((uint32_t) 1073764376U);
    
    /* reg get i2c2->dr:  */
    ;
    
    uint16_t n_r2 = ivory_hw_io_read_u16((uint32_t) 1073764368U);
    uint16_t n_r3 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
    
    /* reg modify i2c2->cr1: setBit i2c_cr1_stop */
    ;
    
    uint16_t n_cse1 = (uint16_t) ((uint16_t) 1U << (uint16_t) 9U);
    
    ivory_hw_io_write_u16((uint32_t) 1073764352U, (uint16_t) (n_r3 | n_cse1));
    for (int32_t n_ix4 = (int32_t) 14; n_ix4 >= (int32_t) 0; n_ix4--) {
        /* reg get i2c2->cr1:  */
        ;
        
        uint16_t n_r5 = ivory_hw_io_read_u16((uint32_t) 1073764352U);
        
        if ((bool) (0 == (uint8_t) (uint16_t) ((uint16_t) (n_r5 >> (uint16_t) 9U) & (uint16_t) 1U))) {
            break;
        }
    }
    
    uint16_t n_r6 = ivory_hw_io_read_u16((uint32_t) 1073764372U);
    
    /* reg modify i2c2->sr1: clearBit i2c_sr1_smbalert, clearBit i2c_sr1_timeout, clearBit i2c_sr1_pecerr, clearBit i2c_sr1_ovr, clearBit i2c_sr1_af, clearBit i2c_sr1_arlo, clearBit i2c_sr1_berr, clearBit i2c_sr1_txe, clearBit i2c_sr1_rxne, clearBit i2c_sr1_stopf, clearBit i2c_sr1_add10, clearBit i2c_sr1_btf, clearBit i2c_sr1_addr, clearBit i2c_sr1_sb */
    ;
    
    uint16_t n_cse19 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 15U);
    uint16_t n_cse22 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 14U);
    uint16_t n_cse25 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 12U);
    uint16_t n_cse28 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 11U);
    uint16_t n_cse31 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 10U);
    uint16_t n_cse33 = (uint16_t) ~n_cse1;
    uint16_t n_cse36 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 8U);
    uint16_t n_cse39 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 7U);
    uint16_t n_cse42 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 6U);
    uint16_t n_cse45 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 4U);
    uint16_t n_cse48 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 3U);
    uint16_t n_cse51 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 2U);
    uint16_t n_cse54 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << (uint16_t) 1U);
    uint16_t n_cse57 = (uint16_t) ~(uint16_t) ((uint16_t) 1U << 0);
    
    ivory_hw_io_write_u16((uint32_t) 1073764372U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) (n_r6 & n_cse19) & n_cse22) & n_cse25) & n_cse28) & n_cse31) & n_cse33) & n_cse36) & n_cse39) & n_cse42) & n_cse45) & n_cse48) & n_cse51) & n_cse54) & n_cse57));
    
    uint16_t n_r7 = ivory_hw_io_read_u16((uint32_t) 1073764372U);
    
    /* reg modify i2c2->sr1: clearBit i2c_sr1_smbalert, clearBit i2c_sr1_timeout, clearBit i2c_sr1_pecerr, clearBit i2c_sr1_ovr, clearBit i2c_sr1_af, clearBit i2c_sr1_arlo, clearBit i2c_sr1_berr, clearBit i2c_sr1_txe, clearBit i2c_sr1_rxne, clearBit i2c_sr1_stopf, clearBit i2c_sr1_add10, clearBit i2c_sr1_btf, clearBit i2c_sr1_addr, clearBit i2c_sr1_sb */
    ivory_hw_io_write_u16((uint32_t) 1073764372U, (uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) ((uint16_t) (n_cse57 & n_cse54) & n_cse51) & n_cse48) & n_cse45) & n_cse42) & n_cse39) & n_cse36) & n_cse33) & n_cse31) & n_cse28) & n_cse25) & n_cse22) & n_cse19) & n_r7));
    
    uint16_t n_r8 = ivory_hw_io_read_u16((uint32_t) 1073764356U);
    
    /* reg modify i2c2->cr2: clearBit i2c_cr2_itbufen, clearBit i2c_cr2_itevten, clearBit i2c_cr2_iterren */
    ivory_hw_io_write_u16((uint32_t) 1073764356U, (uint16_t) ((uint16_t) ((uint16_t) (n_cse36 & n_cse33) & n_cse31) & n_r8));
    
    uint8_t n_deref9 = i2c2_driverstate;
    
    if ((bool) (0 != n_deref9)) {
        i2c2_driverstate = (uint8_t) 0U;
        i2c2_resbuffer.resultcode = (uint8_t) 1U;
        
        uint32_t n_deref10 = i2c2_error_run;
        
        i2c2_error_run = (uint32_t) ((uint32_t) 1U + n_deref10);
        emitter_i2c2_error_irq_chan_191(&i2c2_resbuffer);
    }
    /* reg set nvic_iser1: setBit nvic_iser_setena.[2] */
    ivory_hw_io_write_u32((uint32_t) 3758153988U, (uint32_t) ((uint32_t) 1U << (uint32_t) 2U));
}

void emitter_i2c2_error_irq_chan_191(const struct i2c_transaction_result *n_var0)
{
    emitter_i2c2_error_irq_chan_191_thread_signal_I2C2_ER_IRQHandler_emit(n_var0);
}
