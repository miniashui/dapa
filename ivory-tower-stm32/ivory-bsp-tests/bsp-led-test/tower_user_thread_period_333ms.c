/* This file has been autogenerated by Ivory
 * Compiler version  0.1.0.5
 */
#include "tower_user_thread_period_333ms.h"

static void emitter_per_2_chan_2(const bool *n_var0);

void callback_newoutput_2_thread_period_333ms(const bool *n_var0)
{
    bool n_deref0 = *n_var0;
    
    if (n_deref0) {
        uint32_t n_r1 = ivory_hw_io_read_u32((uint32_t) 1073875992U);
        
        /* reg modify gpioD->bsrr: setBit gpio_br_4 */
        ;
        ivory_hw_io_write_u32((uint32_t) 1073875992U, (uint32_t) (n_r1 | (uint32_t) ((uint32_t) 1U << (uint32_t) 20U)));
        
        uint32_t n_r2 = ivory_hw_io_read_u32((uint32_t) 1073875968U);
        
        /* reg modify gpioD->mode: setField gpio_mode_4 */
        ;
        ivory_hw_io_write_u32((uint32_t) 1073875968U, (uint32_t) ((uint32_t) (n_r2 & (uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 8U)) | (uint32_t) ((uint32_t) (uint8_t) ((uint8_t) 1U << 0) << (uint32_t) 8U)));
    } else {
        uint32_t n_r3 = ivory_hw_io_read_u32((uint32_t) 1073875968U);
        
        /* reg modify gpioD->mode: setField gpio_mode_4 */
        ;
        ivory_hw_io_write_u32((uint32_t) 1073875968U, (uint32_t) ((uint32_t) ((uint32_t) ~(uint32_t) ((uint32_t) 3U << (uint32_t) 8U) & n_r3) | (uint32_t) ((uint32_t) (uint8_t) ((uint8_t) 3U << 0) << (uint32_t) 8U)));
    }
}

void callback_per_2_thread_period_333ms(const int64_t *n_var0)
{
    int64_t n_deref0 = *n_var0;
    int64_t n_cse1 = (int64_t) (n_deref0 % (int64_t) 666000);
    bool n_local1 = (bool) ((int64_t) ((bool) (n_cse1 < (int64_t) 0) ? (int64_t) (n_cse1 + (int64_t) 666000) : n_cse1) < (int64_t) 333000);
    bool *n_ref2 = &n_local1;
    
    emitter_per_2_chan_2(n_ref2);
}

void emitter_per_2_chan_2(const bool *n_var0)
{
    emitter_per_2_chan_2_thread_period_333ms_emit(n_var0);
}
